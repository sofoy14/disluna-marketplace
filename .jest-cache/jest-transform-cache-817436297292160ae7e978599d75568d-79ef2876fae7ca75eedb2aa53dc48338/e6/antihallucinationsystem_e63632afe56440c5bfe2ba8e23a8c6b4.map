{"version":3,"names":["cov_13vodomuh0","actualCoverage","exports","createAntiHallucinationSystem","openai_1","s","__importDefault","require","AntiHallucinationSystem","client","modelName","constructor","apiKey","f","default","baseURL","factCheckResponse","query","response","sources","config","console","log","length","factCheckPrompt","map","source","index","title","url","content","substring","join","chat","completions","create","model","messages","role","temperature","max_tokens","b","choices","message","result","JSON","parse","isAccurate","confidence","toFixed","issues","corrections","error","generateConservativeResponse","previousResponse","conservativePrompt","validateLegalReferences","validationPrompt","validationResponse","validReferences","invalidReferences","missingReferences","applyCorrections","originalResponse","factCheckResult","correctionPrompt","issue","correction","correctionResponse","correctedContent"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\anti-hallucination\\anti-hallucination-system.ts"],"sourcesContent":["import OpenAI from \"openai\"\r\n\r\nexport interface FactCheckResult {\r\n  isAccurate: boolean\r\n  confidence: number\r\n  issues: string[]\r\n  corrections: string[]\r\n  sources: string[]\r\n}\r\n\r\nexport interface AntiHallucinationConfig {\r\n  enableFactChecking: boolean\r\n  requireSources: boolean\r\n  maxConfidenceThreshold: number\r\n  enableSourceVerification: boolean\r\n  enableCrossValidation: boolean\r\n}\r\n\r\n/**\r\n * Sistema anti-alucinaci√≥n para mejorar la precisi√≥n de las respuestas\r\n */\r\nexport class AntiHallucinationSystem {\r\n  private client: OpenAI\r\n  private modelName: string = 'alibaba/tongyi-deepresearch-30b-a3b'\r\n\r\n  constructor(apiKey: string) {\r\n    this.client = new OpenAI({\r\n      apiKey,\r\n      baseURL: \"https://openrouter.ai/api/v1\"\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Verifica la precisi√≥n de una respuesta antes de enviarla\r\n   */\r\n  async factCheckResponse(\r\n    query: string,\r\n    response: string,\r\n    sources: Array<{ title: string; url: string; content: string }>,\r\n    config: AntiHallucinationConfig\r\n  ): Promise<FactCheckResult> {\r\n    console.log(`üîç VERIFICACI√ìN ANTI-ALUCINACI√ìN`)\r\n    console.log(`üìù Query: \"${query}\"`)\r\n    console.log(`üìÑ Respuesta: ${response.length} caracteres`)\r\n    console.log(`üìö Fuentes: ${sources.length}`)\r\n\r\n    const factCheckPrompt = `\r\nEres un verificador de hechos especializado en derecho colombiano. Tu tarea es identificar alucinaciones y errores en respuestas legales.\r\n\r\nCONSULTA ORIGINAL: \"${query}\"\r\n\r\nRESPUESTA A VERIFICAR:\r\n${response}\r\n\r\nFUENTES DISPONIBLES:\r\n${sources.map((source, index) => `\r\n${index + 1}. ${source.title}\r\n   URL: ${source.url}\r\n   Contenido: ${source.content.substring(0, 500)}...\r\n`).join('\\n')}\r\n\r\nCRITERIOS DE VERIFICACI√ìN:\r\n1. ¬øLas referencias legales son correctas? (art√≠culos, leyes, sentencias)\r\n2. ¬øLos n√∫meros de art√≠culos existen realmente?\r\n3. ¬øLas fechas son coherentes?\r\n4. ¬øLos nombres de entidades son correctos?\r\n5. ¬øLa informaci√≥n est√° respaldada por las fuentes?\r\n6. ¬øHay informaci√≥n inventada o especulativa?\r\n\r\nINSTRUCCIONES:\r\n- Si encuentras informaci√≥n NO respaldada por las fuentes, marca como alucinaci√≥n\r\n- Si encuentras referencias legales incorrectas, marca como error\r\n- Si encuentras informaci√≥n especulativa sin fundamento, marca como problema\r\n- S√© estricto: es mejor ser conservador que permitir alucinaciones\r\n\r\nResponde en formato JSON:\r\n{\r\n  \"isAccurate\": true/false,\r\n  \"confidence\": 0.0-1.0,\r\n  \"issues\": [\"problema1\", \"problema2\"],\r\n  \"corrections\": [\"correcci√≥n1\", \"correcci√≥n2\"],\r\n  \"sources\": [\"fuente1\", \"fuente2\"]\r\n}\r\n`\r\n\r\n    try {\r\n      const factCheckResponse = await this.client.chat.completions.create({\r\n        model: this.modelName,\r\n        messages: [\r\n          {\r\n            role: \"system\",\r\n            content: factCheckPrompt\r\n          }\r\n        ],\r\n        temperature: 0.1, // Muy baja temperatura para precisi√≥n\r\n        max_tokens: 1000\r\n      })\r\n\r\n      const content = factCheckResponse.choices[0]?.message?.content || '{}'\r\n      const result = JSON.parse(content) as FactCheckResult\r\n\r\n      console.log(`üéØ Verificaci√≥n completada:`)\r\n      console.log(`   üìä Precisi√≥n: ${result.isAccurate ? '‚úÖ' : '‚ùå'}`)\r\n      console.log(`   üéØ Confianza: ${result.confidence.toFixed(2)}`)\r\n      console.log(`   ‚ö†Ô∏è Problemas: ${result.issues.length}`)\r\n      console.log(`   üîß Correcciones: ${result.corrections.length}`)\r\n\r\n      return result\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error en verificaci√≥n de hechos:', error)\r\n      \r\n      // Fallback conservador\r\n      return {\r\n        isAccurate: false,\r\n        confidence: 0.3,\r\n        issues: ['Error en verificaci√≥n autom√°tica'],\r\n        corrections: ['Revisar manualmente la respuesta'],\r\n        sources: []\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Genera una respuesta m√°s conservadora y precisa\r\n   */\r\n  async generateConservativeResponse(\r\n    query: string,\r\n    sources: Array<{ title: string; url: string; content: string }>,\r\n    previousResponse?: string\r\n  ): Promise<string> {\r\n    console.log(`üõ°Ô∏è GENERANDO RESPUESTA CONSERVADORA`)\r\n    console.log(`üìù Query: \"${query}\"`)\r\n    console.log(`üìö Fuentes: ${sources.length}`)\r\n\r\n    const conservativePrompt = `\r\nEres un asistente legal experto en derecho colombiano. Genera una respuesta PRECISA y CONSERVADORA bas√°ndote √öNICAMENTE en la informaci√≥n proporcionada.\r\n\r\nCONSULTA: \"${query}\"\r\n\r\nINFORMACI√ìN DISPONIBLE:\r\n${sources.map((source, index) => `\r\n${index + 1}. ${source.title}\r\n   URL: ${source.url}\r\n   Contenido: ${source.content}\r\n`).join('\\n')}\r\n\r\nINSTRUCCIONES ESTRICTAS:\r\n1. Responde √öNICAMENTE con informaci√≥n respaldada por las fuentes\r\n2. Si no tienes informaci√≥n suficiente, dilo claramente\r\n3. NO inventes art√≠culos, leyes o sentencias\r\n4. NO hagas especulaciones sin fundamento\r\n5. Si mencionas un art√≠culo, aseg√∫rate de que existe\r\n6. Si mencionas una entidad, aseg√∫rate de que es correcta\r\n7. Usa lenguaje conservador: \"seg√∫n las fuentes\", \"de acuerdo con\", \"se indica que\"\r\n8. Si hay informaci√≥n contradictoria, menciona ambas perspectivas\r\n9. Termina con una advertencia sobre consultar fuentes oficiales\r\n\r\nFORMATO DE RESPUESTA:\r\n- Introducci√≥n clara del tema\r\n- Desarrollo basado en fuentes\r\n- Referencias espec√≠ficas cuando sea posible\r\n- Advertencia sobre limitaciones\r\n- Recomendaci√≥n de consulta profesional\r\n\r\n${previousResponse ? `\\nRESPUESTA ANTERIOR (para referencia):\\n${previousResponse}` : ''}\r\n`\r\n\r\n    try {\r\n      const response = await this.client.chat.completions.create({\r\n        model: this.modelName,\r\n        messages: [\r\n          {\r\n            role: \"system\",\r\n            content: conservativePrompt\r\n          },\r\n          {\r\n            role: \"user\",\r\n            content: `Genera una respuesta conservadora y precisa para: \"${query}\"`\r\n          }\r\n        ],\r\n        temperature: 0.2, // Temperatura baja para precisi√≥n\r\n        max_tokens: 3000\r\n      })\r\n\r\n      const content = response.choices[0]?.message?.content || 'No se pudo generar respuesta'\r\n\r\n      console.log(`‚úÖ Respuesta conservadora generada: ${content.length} caracteres`)\r\n      return content\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error generando respuesta conservadora:', error)\r\n      \r\n      return `Disculpe, hubo un error procesando su consulta. Por favor, consulte directamente las fuentes oficiales para obtener informaci√≥n precisa sobre: \"${query}\"`\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Valida referencias legales espec√≠ficas\r\n   */\r\n  async validateLegalReferences(\r\n    response: string,\r\n    sources: Array<{ title: string; url: string; content: string }>\r\n  ): Promise<{\r\n    validReferences: string[]\r\n    invalidReferences: string[]\r\n    missingReferences: string[]\r\n  }> {\r\n    console.log(`üìã VALIDANDO REFERENCIAS LEGALES`)\r\n\r\n    const validationPrompt = `\r\nEres un experto en derecho colombiano. Valida las referencias legales mencionadas en la respuesta.\r\n\r\nRESPUESTA A VALIDAR:\r\n${response}\r\n\r\nFUENTES DISPONIBLES:\r\n${sources.map((source, index) => `\r\n${index + 1}. ${source.title}\r\n   Contenido: ${source.content}\r\n`).join('\\n')}\r\n\r\nTAREA:\r\n1. Identifica todas las referencias legales en la respuesta (art√≠culos, leyes, sentencias, decretos)\r\n2. Verifica si cada referencia est√° respaldada por las fuentes\r\n3. Marca como inv√°lidas las referencias que no aparecen en las fuentes\r\n4. Identifica referencias que deber√≠an estar pero no est√°n\r\n\r\nResponde en formato JSON:\r\n{\r\n  \"validReferences\": [\"referencia v√°lida 1\", \"referencia v√°lida 2\"],\r\n  \"invalidReferences\": [\"referencia inv√°lida 1\", \"referencia inv√°lida 2\"],\r\n  \"missingReferences\": [\"referencia faltante 1\", \"referencia faltante 2\"]\r\n}\r\n`\r\n\r\n    try {\r\n      const validationResponse = await this.client.chat.completions.create({\r\n        model: this.modelName,\r\n        messages: [\r\n          {\r\n            role: \"system\",\r\n            content: validationPrompt\r\n          }\r\n        ],\r\n        temperature: 0.1,\r\n        max_tokens: 800\r\n      })\r\n\r\n      const content = validationResponse.choices[0]?.message?.content || '{}'\r\n      const result = JSON.parse(content)\r\n\r\n      console.log(`üìä Validaci√≥n completada:`)\r\n      console.log(`   ‚úÖ Referencias v√°lidas: ${result.validReferences?.length || 0}`)\r\n      console.log(`   ‚ùå Referencias inv√°lidas: ${result.invalidReferences?.length || 0}`)\r\n      console.log(`   ‚ö†Ô∏è Referencias faltantes: ${result.missingReferences?.length || 0}`)\r\n\r\n      return result\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error validando referencias:', error)\r\n      \r\n      return {\r\n        validReferences: [],\r\n        invalidReferences: [],\r\n        missingReferences: []\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Aplica correcciones a una respuesta bas√°ndose en la verificaci√≥n\r\n   */\r\n  async applyCorrections(\r\n    originalResponse: string,\r\n    factCheckResult: FactCheckResult,\r\n    sources: Array<{ title: string; url: string; content: string }>\r\n  ): Promise<string> {\r\n    if (factCheckResult.isAccurate && factCheckResult.confidence > 0.8) {\r\n      console.log(`‚úÖ Respuesta precisa, no se requieren correcciones`)\r\n      return originalResponse\r\n    }\r\n\r\n    console.log(`üîß APLICANDO CORRECCIONES`)\r\n    console.log(`‚ö†Ô∏è Problemas encontrados: ${factCheckResult.issues.length}`)\r\n\r\n    const correctionPrompt = `\r\nEres un editor legal experto. Corrige la respuesta eliminando alucinaciones y errores.\r\n\r\nRESPUESTA ORIGINAL:\r\n${originalResponse}\r\n\r\nPROBLEMAS IDENTIFICADOS:\r\n${factCheckResult.issues.map((issue, index) => `${index + 1}. ${issue}`).join('\\n')}\r\n\r\nCORRECCIONES SUGERIDAS:\r\n${factCheckResult.corrections.map((correction, index) => `${index + 1}. ${correction}`).join('\\n')}\r\n\r\nFUENTES DISPONIBLES:\r\n${sources.map((source, index) => `\r\n${index + 1}. ${source.title}\r\n   Contenido: ${source.content.substring(0, 300)}...\r\n`).join('\\n')}\r\n\r\nINSTRUCCIONES:\r\n1. Elimina informaci√≥n no respaldada por las fuentes\r\n2. Corrige referencias legales incorrectas\r\n3. Mant√©n solo informaci√≥n verificable\r\n4. Usa lenguaje conservador\r\n5. Incluye advertencias sobre limitaciones\r\n6. Agrega recomendaci√≥n de consulta profesional\r\n\r\nGenera la respuesta corregida:\r\n`\r\n\r\n    try {\r\n      const correctionResponse = await this.client.chat.completions.create({\r\n        model: this.modelName,\r\n        messages: [\r\n          {\r\n            role: \"system\",\r\n            content: correctionPrompt\r\n          }\r\n        ],\r\n        temperature: 0.2,\r\n        max_tokens: 3000\r\n      })\r\n\r\n      const correctedContent = correctionResponse.choices[0]?.message?.content || originalResponse\r\n\r\n      console.log(`‚úÖ Correcciones aplicadas: ${correctedContent.length} caracteres`)\r\n      return correctedContent\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error aplicando correcciones:', error)\r\n      \r\n      // Fallback: agregar advertencia a la respuesta original\r\n      return `${originalResponse}\r\n\r\n‚ö†Ô∏è ADVERTENCIA IMPORTANTE: Esta respuesta puede contener informaci√≥n no verificada. Por favor, consulte las fuentes oficiales para confirmar la informaci√≥n antes de tomar decisiones legales.`\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Instancia singleton del sistema anti-alucinaci√≥n\r\n */\r\nexport function createAntiHallucinationSystem(apiKey: string): AntiHallucinationSystem {\r\n  return new AntiHallucinationSystem(apiKey)\r\n}\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}