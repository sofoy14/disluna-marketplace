{"version":3,"names":["cov_2futxasbvv","actualCoverage","s","sonner_1","require","llm_list_1","fetchHostedModels","profile","f","providers","use_azure_openai","b","push","response","fetch","ok","Error","data","json","modelsToAdd","provider","providerKey","isUsingEnvKeyMap","models","LLM_LIST_MAP","Array","isArray","envKeyMap","hostedModels","error","console","warn","exports","fetchOllamaModels","process","env","NEXT_PUBLIC_OLLAMA_URL","localModels","map","model","modelId","name","modelName","hostedId","platformLink","imageInput","fetchOpenRouterModels","openRouterModels","id","maxContext","context_length","toast"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\models\\fetch-models.ts"],"sourcesContent":["import { Tables } from \"@/supabase/types\"\r\nimport { LLM, LLMID, OpenRouterLLM } from \"@/types\"\r\nimport { toast } from \"sonner\"\r\nimport { LLM_LIST_MAP } from \"./llm/llm-list\"\r\n\r\nexport const fetchHostedModels = async (profile: Tables<\"profiles\">) => {\r\n  try {\r\n    const providers = [\"google\", \"anthropic\", \"mistral\", \"groq\", \"perplexity\"]\r\n\r\n    if (profile.use_azure_openai) {\r\n      providers.push(\"azure\")\r\n    } else {\r\n      providers.push(\"openai\")\r\n    }\r\n\r\n    const response = await fetch(\"/api/keys\")\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Server is not responding.`)\r\n    }\r\n\r\n    const data = await response.json()\r\n\r\n    let modelsToAdd: LLM[] = []\r\n\r\n    for (const provider of providers) {\r\n      let providerKey: keyof typeof profile\r\n\r\n      if (provider === \"google\") {\r\n        providerKey = \"google_gemini_api_key\"\r\n      } else if (provider === \"azure\") {\r\n        providerKey = \"azure_openai_api_key\"\r\n      } else {\r\n        providerKey = `${provider}_api_key` as keyof typeof profile\r\n      }\r\n\r\n      if (profile?.[providerKey] || data.isUsingEnvKeyMap[provider]) {\r\n        const models = LLM_LIST_MAP[provider]\r\n\r\n        if (Array.isArray(models)) {\r\n          modelsToAdd.push(...models)\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      envKeyMap: data.isUsingEnvKeyMap,\r\n      hostedModels: modelsToAdd\r\n    }\r\n  } catch (error) {\r\n    console.warn(\"Error fetching hosted models: \" + error)\r\n  }\r\n}\r\n\r\nexport const fetchOllamaModels = async () => {\r\n  try {\r\n    const response = await fetch(\r\n      process.env.NEXT_PUBLIC_OLLAMA_URL + \"/api/tags\"\r\n    )\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Ollama server is not responding.`)\r\n    }\r\n\r\n    const data = await response.json()\r\n\r\n    const localModels: LLM[] = data.models.map((model: any) => ({\r\n      modelId: model.name as LLMID,\r\n      modelName: model.name,\r\n      provider: \"ollama\",\r\n      hostedId: model.name,\r\n      platformLink: \"https://ollama.ai/library\",\r\n      imageInput: false\r\n    }))\r\n\r\n    return localModels\r\n  } catch (error) {\r\n    console.warn(\"Error fetching Ollama models: \" + error)\r\n  }\r\n}\r\n\r\nexport const fetchOpenRouterModels = async () => {\r\n  try {\r\n    const response = await fetch(\"https://openrouter.ai/api/v1/models\")\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`OpenRouter server is not responding.`)\r\n    }\r\n\r\n    const { data } = await response.json()\r\n\r\n    const openRouterModels = data.map(\r\n      (model: {\r\n        id: string\r\n        name: string\r\n        context_length: number\r\n      }): OpenRouterLLM => ({\r\n        modelId: model.id as LLMID,\r\n        modelName: model.id,\r\n        provider: \"openrouter\",\r\n        hostedId: model.name,\r\n        platformLink: \"https://openrouter.dev\",\r\n        imageInput: false,\r\n        maxContext: model.context_length\r\n      })\r\n    )\r\n\r\n    return openRouterModels\r\n  } catch (error) {\r\n    console.error(\"Error fetching Open Router models: \" + error)\r\n    toast.error(\"Error fetching Open Router models: \" + error)\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}