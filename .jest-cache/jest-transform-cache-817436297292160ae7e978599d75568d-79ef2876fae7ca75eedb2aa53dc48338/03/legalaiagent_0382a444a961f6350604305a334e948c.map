{"version":3,"names":["cov_k5221buk5","actualCoverage","s","chat_memory_manager_1","require","dynamic_search_orchestrator_1","legal_search_orchestrator_1","legal_search_planner_1","LegalAIAgent","memoryManager","options","constructor","f","ChatMemoryManager","getInstance","processQuery","userQuery","messageId","console","log","chatId","userId","enableMemory","b","enableAgenticSearch","repeat","chatContext","getChatContext","conversationHistory","length","decision","makeAgenticDecision","action","confidence","toFixed","reasoning","response","executeSearchAction","executeRespondAction","executeClarifyAction","executeFollowUpAction","saveMessage","content","metadata","error","errorResponse","searchExecuted","memory","timestamp","Date","contextInfo","currentContext","searchHistory","slice","map","query","results","quality","join","userPreferences","preferredSearchStrategy","maxSearchRounds","enableModelDecision","decisionPrompt","client","chat","completions","create","model","messages","role","temperature","max_tokens","stream","choices","message","parseAgentDecision","includes","searchStrategy","searchQueries","maxRounds","searchResult","runDynamicSearchWorkflow","maxSearchesPerRound","searchTimeoutMs","searchRounds","totalRounds","totalSearches","totalResults","finalQuality","modelDecisions","sources","allResults","result","title","url","type","recordSearch","generateResponseWithContext","finalContext","now","searchPlan","planLegalSearchStrategy","maxQueries","workflow","runLegalSearchWorkflow","maxResults","maxAttempts","Math","max","queries","attempts","source","modelContext","clarificationPrompt","followUpPrompt","searchContext","systemPrompt","jsonText","extractJson","parsed","JSON","parse","start","indexOf","end","lastIndexOf","Error","getAgentStats","chatStats","getMemoryStats","memoryEnabled","agenticSearchEnabled","exports"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\agents\\legal-ai-agent.ts"],"sourcesContent":["import OpenAI from \"openai\"\r\nimport { ChatMemoryManager, ChatContext } from \"@/lib/memory/chat-memory-manager\"\r\nimport { runDynamicSearchWorkflow } from \"@/lib/tools/dynamic-search-orchestrator\"\r\nimport { runLegalSearchWorkflow } from \"@/lib/tools/legal-search-orchestrator\"\r\nimport { planLegalSearchStrategy } from \"@/lib/tools/legal-search-planner\"\r\n\r\nexport interface AgentDecision {\r\n  action: 'search' | 'respond' | 'clarify' | 'follow_up'\r\n  confidence: number\r\n  reasoning: string\r\n  searchStrategy?: 'dynamic' | 'traditional' | 'hybrid'\r\n  searchQueries?: string[]\r\n  maxRounds?: number\r\n}\r\n\r\nexport interface AgentResponse {\r\n  content: string\r\n  action: string\r\n  metadata: {\r\n    searchExecuted: boolean\r\n    searchRounds?: number\r\n    totalSearches?: number\r\n    totalResults?: number\r\n    finalQuality?: number\r\n    modelDecisions?: number\r\n    searchStrategy?: string\r\n    sources?: Array<{\r\n      title: string\r\n      url: string\r\n      type: string\r\n      quality: number\r\n    }>\r\n  }\r\n  memory: {\r\n    messageId: string\r\n    timestamp: Date\r\n  }\r\n}\r\n\r\nexport interface AgentOptions {\r\n  client: OpenAI\r\n  model: string\r\n  chatId: string\r\n  userId: string\r\n  enableMemory: boolean\r\n  enableAgenticSearch: boolean\r\n  maxSearchRounds: number\r\n  searchTimeoutMs: number\r\n}\r\n\r\n/**\r\n * AI Agent con capacidades agenticas de b√∫squeda y memoria\r\n */\r\nexport class LegalAIAgent {\r\n  private memoryManager: ChatMemoryManager\r\n  private options: AgentOptions\r\n\r\n  constructor(options: AgentOptions) {\r\n    this.options = options\r\n    this.memoryManager = ChatMemoryManager.getInstance()\r\n  }\r\n\r\n  /**\r\n   * Procesa una consulta del usuario con capacidades agenticas\r\n   */\r\n  async processQuery(\r\n    userQuery: string,\r\n    messageId: string\r\n  ): Promise<AgentResponse> {\r\n    console.log(`\\nü§ñ AI AGENT PROCESANDO CONSULTA`)\r\n    console.log(`üìù Query: \"${userQuery}\"`)\r\n    console.log(`üí¨ Chat ID: ${this.options.chatId}`)\r\n    console.log(`üë§ User ID: ${this.options.userId}`)\r\n    console.log(`üß† Memoria: ${this.options.enableMemory ? 'ACTIVADA' : 'DESACTIVADA'}`)\r\n    console.log(`üîç B√∫squeda agentica: ${this.options.enableAgenticSearch ? 'ACTIVADA' : 'DESACTIVADA'}`)\r\n    console.log(`${'='.repeat(80)}`)\r\n\r\n    try {\r\n      // 1. Cargar contexto de memoria si est√° habilitado\r\n      let chatContext: ChatContext | null = null\r\n      if (this.options.enableMemory) {\r\n        chatContext = await this.memoryManager.getChatContext(\r\n          this.options.chatId,\r\n          this.options.userId\r\n        )\r\n        console.log(`üß† Contexto cargado: ${chatContext.conversationHistory.length} mensajes`)\r\n      }\r\n\r\n      // 2. Tomar decisi√≥n agentica sobre qu√© hacer\r\n      const decision = await this.makeAgenticDecision(userQuery, chatContext)\r\n      console.log(`ü§ñ Decisi√≥n agentica: ${decision.action} (confianza: ${decision.confidence.toFixed(2)})`)\r\n      console.log(`üí≠ Razonamiento: ${decision.reasoning}`)\r\n\r\n      // 3. Ejecutar acci√≥n basada en la decisi√≥n\r\n      let response: AgentResponse\r\n\r\n      switch (decision.action) {\r\n        case 'search':\r\n          response = await this.executeSearchAction(userQuery, decision, chatContext)\r\n          break\r\n        case 'respond':\r\n          response = await this.executeRespondAction(userQuery, chatContext)\r\n          break\r\n        case 'clarify':\r\n          response = await this.executeClarifyAction(userQuery, chatContext)\r\n          break\r\n        case 'follow_up':\r\n          response = await this.executeFollowUpAction(userQuery, chatContext)\r\n          break\r\n        default:\r\n          response = await this.executeRespondAction(userQuery, chatContext)\r\n      }\r\n\r\n      // 4. Guardar en memoria si est√° habilitado\r\n      if (this.options.enableMemory) {\r\n        await this.memoryManager.saveMessage(\r\n          this.options.chatId,\r\n          this.options.userId,\r\n          messageId,\r\n          response.content,\r\n          'assistant',\r\n          response.metadata\r\n        )\r\n      }\r\n\r\n      console.log(`‚úÖ Respuesta generada: ${response.content.length} caracteres`)\r\n      return response\r\n\r\n    } catch (error) {\r\n      console.error(`‚ùå Error en AI Agent:`, error)\r\n      \r\n      // Respuesta de error con fallback\r\n      const errorResponse: AgentResponse = {\r\n        content: `Disculpa, hubo un error t√©cnico al procesar tu consulta. Por favor, intenta nuevamente.`,\r\n        action: 'error',\r\n        metadata: {\r\n          searchExecuted: false\r\n        },\r\n        memory: {\r\n          messageId,\r\n          timestamp: new Date()\r\n        }\r\n      }\r\n\r\n      if (this.options.enableMemory) {\r\n        await this.memoryManager.saveMessage(\r\n          this.options.chatId,\r\n          this.options.userId,\r\n          messageId,\r\n          errorResponse.content,\r\n          'assistant',\r\n          errorResponse.metadata\r\n        )\r\n      }\r\n\r\n      return errorResponse\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Toma una decisi√≥n agentica sobre qu√© acci√≥n realizar\r\n   */\r\n  private async makeAgenticDecision(\r\n    userQuery: string,\r\n    chatContext: ChatContext | null\r\n  ): Promise<AgentDecision> {\r\n    try {\r\n      const contextInfo = chatContext ? `\r\nHISTORIAL DE CONVERSACI√ìN:\r\n${chatContext.currentContext}\r\n\r\nB√öSQUEDAS ANTERIORES:\r\n${chatContext.searchHistory.slice(-3).map(s => `- \"${s.query}\" (${s.results} resultados, calidad: ${s.quality}/10)`).join('\\n')}\r\n\r\nPREFERENCIAS DEL USUARIO:\r\n- Estrategia: ${chatContext.userPreferences.preferredSearchStrategy}\r\n- M√°ximo de rondas: ${chatContext.userPreferences.maxSearchRounds}\r\n- Decisi√≥n del modelo: ${chatContext.userPreferences.enableModelDecision ? 'Activada' : 'Desactivada'}\r\n` : 'Sin historial previo'\r\n\r\n      const decisionPrompt = `Eres un agente de IA legal experto que debe decidir qu√© acci√≥n tomar para responder una consulta del usuario.\r\n\r\nCONSULTA ACTUAL: \"${userQuery}\"\r\n\r\n${contextInfo}\r\n\r\nCAPACIDADES DISPONIBLES:\r\n1. **search**: Realizar b√∫squeda web din√°mica con m√∫ltiples rondas\r\n2. **respond**: Responder directamente con conocimiento existente\r\n3. **clarify**: Pedir aclaraciones al usuario\r\n4. **follow_up**: Hacer preguntas de seguimiento\r\n\r\nCRITERIOS DE DECISI√ìN:\r\n- Si la consulta requiere informaci√≥n actualizada o espec√≠fica ‚Üí **search**\r\n- Si la consulta es general y tienes conocimiento suficiente ‚Üí **respond**\r\n- Si la consulta es ambigua o incompleta ‚Üí **clarify**\r\n- Si necesitas m√°s informaci√≥n para completar la respuesta ‚Üí **follow_up**\r\n\r\nESTRATEGIAS DE B√öSQUEDA:\r\n- **dynamic**: Sistema de b√∫squeda din√°mica (hasta 10 rondas, modelo decide)\r\n- **traditional**: Sistema tradicional (hasta 5 rondas, criterios fijos)\r\n- **hybrid**: Combinaci√≥n de ambos sistemas\r\n\r\nResponde en formato JSON:\r\n{\r\n  \"action\": \"search|respond|clarify|follow_up\",\r\n  \"confidence\": 0.0-1.0,\r\n  \"reasoning\": \"explicaci√≥n detallada de la decisi√≥n\",\r\n  \"searchStrategy\": \"dynamic|traditional|hybrid\",\r\n  \"searchQueries\": [\"consulta espec√≠fica 1\", \"consulta espec√≠fica 2\"],\r\n  \"maxRounds\": 5-10\r\n}`\r\n\r\n      const response = await this.options.client.chat.completions.create({\r\n        model: this.options.model,\r\n        messages: [\r\n          { role: \"system\", content: decisionPrompt },\r\n          { role: \"user\", content: `Analiza la consulta y decide qu√© acci√≥n tomar: \"${userQuery}\"` }\r\n        ],\r\n        temperature: 0.1,\r\n        max_tokens: 800,\r\n        stream: false\r\n      })\r\n\r\n      const content = response.choices?.[0]?.message?.content || '{}'\r\n      const decision = this.parseAgentDecision(content)\r\n\r\n      // Validar decisi√≥n\r\n      if (!decision.action || !['search', 'respond', 'clarify', 'follow_up'].includes(decision.action)) {\r\n        decision.action = 'search' // Fallback a b√∫squeda\r\n        decision.confidence = 0.5\r\n        decision.reasoning = 'Decisi√≥n inv√°lida, usando fallback a b√∫squeda'\r\n      }\r\n\r\n      return decision\r\n\r\n    } catch (error) {\r\n      console.error('Error en decisi√≥n agentica:', error)\r\n      \r\n      // Fallback a b√∫squeda din√°mica\r\n      return {\r\n        action: 'search',\r\n        confidence: 0.5,\r\n        reasoning: 'Error en decisi√≥n agentica, usando fallback a b√∫squeda',\r\n        searchStrategy: 'dynamic',\r\n        searchQueries: [userQuery],\r\n        maxRounds: this.options.maxSearchRounds\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ejecuta acci√≥n de b√∫squeda\r\n   */\r\n  private async executeSearchAction(\r\n    userQuery: string,\r\n    decision: AgentDecision,\r\n    chatContext: ChatContext | null\r\n  ): Promise<AgentResponse> {\r\n    console.log(`üîç Ejecutando b√∫squeda agentica con estrategia: ${decision.searchStrategy}`)\r\n\r\n    try {\r\n      let searchResult: any\r\n      let metadata: AgentResponse['metadata']\r\n\r\n      if (decision.searchStrategy === 'dynamic' || decision.searchStrategy === 'hybrid') {\r\n        // Usar sistema de b√∫squeda din√°mica\r\n        searchResult = await runDynamicSearchWorkflow(userQuery, {\r\n          client: this.options.client,\r\n          model: this.options.model,\r\n          maxSearchRounds: decision.maxRounds || this.options.maxSearchRounds,\r\n          maxSearchesPerRound: 8,\r\n          searchTimeoutMs: this.options.searchTimeoutMs,\r\n          enableModelDecision: true\r\n        })\r\n\r\n        metadata = {\r\n          searchExecuted: true,\r\n          searchRounds: searchResult.metadata.totalRounds,\r\n          totalSearches: searchResult.metadata.totalSearches,\r\n          totalResults: searchResult.metadata.totalResults,\r\n          finalQuality: searchResult.metadata.finalQuality,\r\n          modelDecisions: searchResult.metadata.modelDecisions,\r\n          searchStrategy: searchResult.metadata.searchStrategy,\r\n          sources: searchResult.allResults.slice(0, 10).map((result: any) => ({\r\n            title: result.title,\r\n            url: result.url,\r\n            type: result.type,\r\n            quality: result.quality\r\n          }))\r\n        }\r\n\r\n        // Registrar b√∫squeda en memoria\r\n        if (this.options.enableMemory && chatContext) {\r\n          await this.memoryManager.recordSearch(\r\n            this.options.chatId,\r\n            this.options.userId,\r\n            userQuery,\r\n            searchResult.metadata.totalResults,\r\n            searchResult.metadata.finalQuality\r\n          )\r\n        }\r\n\r\n        // Generar respuesta usando el contexto enriquecido\r\n        const response = await this.generateResponseWithContext(\r\n          userQuery,\r\n          searchResult.finalContext,\r\n          chatContext\r\n        )\r\n\r\n        return {\r\n          content: response,\r\n          action: 'search',\r\n          metadata,\r\n          memory: {\r\n            messageId: `${this.options.chatId}-${Date.now()}`,\r\n            timestamp: new Date()\r\n          }\r\n        }\r\n\r\n      } else {\r\n        // Usar sistema tradicional\r\n        const searchPlan = await planLegalSearchStrategy({\r\n          client: this.options.client,\r\n          model: this.options.model,\r\n          userQuery,\r\n          maxQueries: 5\r\n        })\r\n\r\n        const workflow = await runLegalSearchWorkflow(userQuery, {\r\n          maxResults: 5,\r\n          maxAttempts: Math.max(searchPlan.queries.length || 0, 1),\r\n          searchTimeoutMs: this.options.searchTimeoutMs,\r\n          searchQueries: searchPlan.queries\r\n        })\r\n\r\n        metadata = {\r\n          searchExecuted: workflow.metadata.searchExecuted,\r\n          searchRounds: 1,\r\n          totalSearches: workflow.metadata.attempts,\r\n          totalResults: workflow.sources.length,\r\n          finalQuality: workflow.sources.length > 0 ? 7 : 3,\r\n          searchStrategy: 'TRADITIONAL',\r\n          sources: workflow.sources.map(source => ({\r\n            title: source.title,\r\n            url: source.url,\r\n            type: source.type,\r\n            quality: 7\r\n          }))\r\n        }\r\n\r\n        // Generar respuesta usando el contexto tradicional\r\n        const response = await this.generateResponseWithContext(\r\n          userQuery,\r\n          workflow.modelContext,\r\n          chatContext\r\n        )\r\n\r\n        return {\r\n          content: response,\r\n          action: 'search',\r\n          metadata,\r\n          memory: {\r\n            messageId: `${this.options.chatId}-${Date.now()}`,\r\n            timestamp: new Date()\r\n          }\r\n        }\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Error en b√∫squeda agentica:', error)\r\n      \r\n      // Fallback a respuesta sin b√∫squeda\r\n      const response = await this.generateResponseWithContext(\r\n        userQuery,\r\n        'Error en b√∫squeda, respondiendo con conocimiento general',\r\n        chatContext\r\n      )\r\n\r\n      return {\r\n        content: response,\r\n        action: 'search',\r\n        metadata: {\r\n          searchExecuted: false\r\n        },\r\n        memory: {\r\n          messageId: `${this.options.chatId}-${Date.now()}`,\r\n          timestamp: new Date()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ejecuta acci√≥n de respuesta directa\r\n   */\r\n  private async executeRespondAction(\r\n    userQuery: string,\r\n    chatContext: ChatContext | null\r\n  ): Promise<AgentResponse> {\r\n    console.log(`üí¨ Respondiendo directamente sin b√∫squeda`)\r\n\r\n    const response = await this.generateResponseWithContext(\r\n      userQuery,\r\n      'Responde usando tu conocimiento legal colombiano sin realizar b√∫squedas web',\r\n      chatContext\r\n    )\r\n\r\n    return {\r\n      content: response,\r\n      action: 'respond',\r\n      metadata: {\r\n        searchExecuted: false\r\n      },\r\n      memory: {\r\n        messageId: `${this.options.chatId}-${Date.now()}`,\r\n        timestamp: new Date()\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ejecuta acci√≥n de aclaraci√≥n\r\n   */\r\n  private async executeClarifyAction(\r\n    userQuery: string,\r\n    chatContext: ChatContext | null\r\n  ): Promise<AgentResponse> {\r\n    console.log(`‚ùì Solicitando aclaraci√≥n`)\r\n\r\n    const clarificationPrompt = `La consulta \"${userQuery}\" es ambigua o incompleta. Genera una pregunta de aclaraci√≥n espec√≠fica para obtener m√°s informaci√≥n del usuario.`\r\n\r\n    const response = await this.options.client.chat.completions.create({\r\n      model: this.options.model,\r\n      messages: [\r\n        { role: \"system\", content: \"Eres un asistente legal que necesita aclarar consultas ambiguas.\" },\r\n        { role: \"user\", content: clarificationPrompt }\r\n      ],\r\n      temperature: 0.3,\r\n      max_tokens: 300,\r\n      stream: false\r\n    })\r\n\r\n    const content = response.choices?.[0]?.message?.content || \"¬øPodr√≠as ser m√°s espec√≠fico en tu consulta?\"\r\n\r\n    return {\r\n      content,\r\n      action: 'clarify',\r\n      metadata: {\r\n        searchExecuted: false\r\n      },\r\n      memory: {\r\n        messageId: `${this.options.chatId}-${Date.now()}`,\r\n        timestamp: new Date()\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ejecuta acci√≥n de seguimiento\r\n   */\r\n  private async executeFollowUpAction(\r\n    userQuery: string,\r\n    chatContext: ChatContext | null\r\n  ): Promise<AgentResponse> {\r\n    console.log(`üîÑ Generando pregunta de seguimiento`)\r\n\r\n    const followUpPrompt = `Bas√°ndote en la consulta \"${userQuery}\" y el contexto de conversaci√≥n, genera una pregunta de seguimiento √∫til para obtener m√°s informaci√≥n espec√≠fica.`\r\n\r\n    const response = await this.options.client.chat.completions.create({\r\n      model: this.options.model,\r\n      messages: [\r\n        { role: \"system\", content: \"Eres un asistente legal que hace preguntas de seguimiento inteligentes.\" },\r\n        { role: \"user\", content: followUpPrompt }\r\n      ],\r\n      temperature: 0.3,\r\n      max_tokens: 300,\r\n      stream: false\r\n    })\r\n\r\n    const content = response.choices?.[0]?.message?.content || \"¬øHay alg√∫n aspecto espec√≠fico que te gustar√≠a que profundice?\"\r\n\r\n    return {\r\n      content,\r\n      action: 'follow_up',\r\n      metadata: {\r\n        searchExecuted: false\r\n      },\r\n      memory: {\r\n        messageId: `${this.options.chatId}-${Date.now()}`,\r\n        timestamp: new Date()\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Genera respuesta usando contexto enriquecido\r\n   */\r\n  private async generateResponseWithContext(\r\n    userQuery: string,\r\n    searchContext: string,\r\n    chatContext: ChatContext | null\r\n  ): Promise<string> {\r\n    const systemPrompt = `Eres un asistente legal experto en derecho colombiano. Utiliza EXCLUSIVAMENTE la informaci√≥n proporcionada para responder la consulta del usuario.\r\n\r\n${searchContext}\r\n\r\n${chatContext ? `CONTEXTO DE CONVERSACI√ìN:\r\n${chatContext.currentContext}` : ''}\r\n\r\nINSTRUCCIONES:\r\n1. Responde de manera completa y precisa\r\n2. Usa terminolog√≠a jur√≠dica apropiada\r\n3. Incluye referencias a art√≠culos y leyes cuando sea relevante\r\n4. Proporciona informaci√≥n pr√°ctica y aplicable\r\n5. Si hay informaci√≥n insuficiente, ind√≠calo claramente\r\n6. Responde en espa√±ol colombiano`\r\n\r\n    const response = await this.options.client.chat.completions.create({\r\n      model: this.options.model,\r\n      messages: [\r\n        { role: \"system\", content: systemPrompt },\r\n        { role: \"user\", content: `Consulta: \"${userQuery}\"` }\r\n      ],\r\n      temperature: 0.2,\r\n      max_tokens: 2000,\r\n      stream: false\r\n    })\r\n\r\n    return response.choices?.[0]?.message?.content || \"No pude generar una respuesta adecuada.\"\r\n  }\r\n\r\n  /**\r\n   * Parsea la decisi√≥n del agente desde JSON\r\n   */\r\n  private parseAgentDecision(content: string): AgentDecision {\r\n    try {\r\n      const jsonText = this.extractJson(content)\r\n      const parsed = JSON.parse(jsonText)\r\n      \r\n      return {\r\n        action: parsed.action || 'search',\r\n        confidence: parsed.confidence || 0.5,\r\n        reasoning: parsed.reasoning || 'Sin razonamiento proporcionado',\r\n        searchStrategy: parsed.searchStrategy || 'dynamic',\r\n        searchQueries: parsed.searchQueries || [],\r\n        maxRounds: parsed.maxRounds || this.options.maxSearchRounds\r\n      }\r\n    } catch (error) {\r\n      console.error('Error parseando decisi√≥n del agente:', error)\r\n      return {\r\n        action: 'search',\r\n        confidence: 0.5,\r\n        reasoning: 'Error parseando decisi√≥n, usando fallback',\r\n        searchStrategy: 'dynamic',\r\n        searchQueries: [],\r\n        maxRounds: this.options.maxSearchRounds\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extrae JSON del contenido\r\n   */\r\n  private extractJson(content: string): string {\r\n    const start = content.indexOf('{')\r\n    const end = content.lastIndexOf('}')\r\n    if (start === -1 || end === -1 || end <= start) {\r\n      throw new Error(\"JSON no encontrado en el contenido\")\r\n    }\r\n    return content.slice(start, end + 1)\r\n  }\r\n\r\n  /**\r\n   * Obtiene estad√≠sticas del agente\r\n   */\r\n  async getAgentStats(): Promise<{\r\n    memoryEnabled: boolean\r\n    agenticSearchEnabled: boolean\r\n    maxSearchRounds: number\r\n    chatStats: {\r\n      totalMessages: number\r\n      totalSearches: number\r\n      averageQuality: number\r\n      lastActivity: Date | null\r\n    }\r\n  }> {\r\n    const chatStats = await this.memoryManager.getMemoryStats(\r\n      this.options.chatId,\r\n      this.options.userId\r\n    )\r\n\r\n    return {\r\n      memoryEnabled: this.options.enableMemory,\r\n      agenticSearchEnabled: this.options.enableAgenticSearch,\r\n      maxSearchRounds: this.options.maxSearchRounds,\r\n      chatStats\r\n    }\r\n  }\r\n}\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}