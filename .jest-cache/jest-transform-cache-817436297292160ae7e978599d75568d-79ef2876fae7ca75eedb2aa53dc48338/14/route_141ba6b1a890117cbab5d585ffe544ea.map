{"version":3,"names":["exports","POST","supabase_js_1","cov_7qnw3btfk","s","require","runtime","request","f","json","userId","supabaseAdmin","createClient","process","env","NEXT_PUBLIC_SUPABASE_URL","SUPABASE_SERVICE_ROLE_KEY","data","error","from","select","eq","single","b","Error","message","Response","JSON","stringify","username","status","errorMessage","errorCode"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\app\\api\\username\\get\\route.ts"],"sourcesContent":["import { Database } from \"@/supabase/types\"\r\nimport { createClient } from \"@supabase/supabase-js\"\r\n\r\nexport const runtime = \"edge\"\r\n\r\nexport async function POST(request: Request) {\r\n  const json = await request.json()\r\n  const { userId } = json as {\r\n    userId: string\r\n  }\r\n\r\n  try {\r\n    const supabaseAdmin = createClient<Database>(\r\n      process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n      process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n    )\r\n\r\n    const { data, error } = await supabaseAdmin\r\n      .from(\"profiles\")\r\n      .select(\"username\")\r\n      .eq(\"user_id\", userId)\r\n      .single()\r\n\r\n    if (!data) {\r\n      throw new Error(error.message)\r\n    }\r\n\r\n    return new Response(JSON.stringify({ username: data.username }), {\r\n      status: 200\r\n    })\r\n  } catch (error: any) {\r\n    const errorMessage = error.error?.message || \"An unexpected error occurred\"\r\n    const errorCode = error.status || 500\r\n    return new Response(JSON.stringify({ message: errorMessage }), {\r\n      status: errorCode\r\n    })\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKAA,OAAA,CAAAC,IAAA,GAAAA,IAAA;AAJA,MAAAC,aAAA;AAAA;AAAA,CAAAC,aAAA,GAAAC,CAAA,OAAAC,OAAA;AAAoD;AAAAF,aAAA,GAAAC,CAAA;AAEvCJ,OAAA,CAAAM,OAAO,GAAG,MAAM;AAEtB,eAAeL,IAAIA,CAACM,OAAgB;EAAA;EAAAJ,aAAA,GAAAK,CAAA;EACzC,MAAMC,IAAI;EAAA;EAAA,CAAAN,aAAA,GAAAC,CAAA,OAAG,MAAMG,OAAO,CAACE,IAAI,EAAE;EACjC,MAAM;IAAEC;EAAM,CAAE;EAAA;EAAA,CAAAP,aAAA,GAAAC,CAAA,OAAGK,IAElB;EAAA;EAAAN,aAAA,GAAAC,CAAA;EAED,IAAI;IACF,MAAMO,aAAa;IAAA;IAAA,CAAAR,aAAA,GAAAC,CAAA,OAAG,IAAAF,aAAA,CAAAU,YAAY,EAChCC,OAAO,CAACC,GAAG,CAACC,wBAAyB,EACrCF,OAAO,CAACC,GAAG,CAACE,yBAA0B,CACvC;IAED,MAAM;MAAEC,IAAI;MAAEC;IAAK,CAAE;IAAA;IAAA,CAAAf,aAAA,GAAAC,CAAA,OAAG,MAAMO,aAAa,CACxCQ,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC,UAAU,CAAC,CAClBC,EAAE,CAAC,SAAS,EAAEX,MAAM,CAAC,CACrBY,MAAM,EAAE;IAAA;IAAAnB,aAAA,GAAAC,CAAA;IAEX,IAAI,CAACa,IAAI,EAAE;MAAA;MAAAd,aAAA,GAAAoB,CAAA;MAAApB,aAAA,GAAAC,CAAA;MACT,MAAM,IAAIoB,KAAK,CAACN,KAAK,CAACO,OAAO,CAAC;IAChC,CAAC;IAAA;IAAA;MAAAtB,aAAA,GAAAoB,CAAA;IAAA;IAAApB,aAAA,GAAAC,CAAA;IAED,OAAO,IAAIsB,QAAQ,CAACC,IAAI,CAACC,SAAS,CAAC;MAAEC,QAAQ,EAAEZ,IAAI,CAACY;IAAQ,CAAE,CAAC,EAAE;MAC/DC,MAAM,EAAE;KACT,CAAC;EACJ,CAAC,CAAC,OAAOZ,KAAU,EAAE;IACnB,MAAMa,YAAY;IAAA;IAAA,CAAA5B,aAAA,GAAAC,CAAA;IAAG;IAAA,CAAAD,aAAA,GAAAoB,CAAA,UAAAL,KAAK,CAACA,KAAK,EAAEO,OAAO;IAAA;IAAA,CAAAtB,aAAA,GAAAoB,CAAA,UAAI,8BAA8B;IAC3E,MAAMS,SAAS;IAAA;IAAA,CAAA7B,aAAA,GAAAC,CAAA;IAAG;IAAA,CAAAD,aAAA,GAAAoB,CAAA,UAAAL,KAAK,CAACY,MAAM;IAAA;IAAA,CAAA3B,aAAA,GAAAoB,CAAA,UAAI,GAAG;IAAA;IAAApB,aAAA,GAAAC,CAAA;IACrC,OAAO,IAAIsB,QAAQ,CAACC,IAAI,CAACC,SAAS,CAAC;MAAEH,OAAO,EAAEM;IAAY,CAAE,CAAC,EAAE;MAC7DD,MAAM,EAAEE;KACT,CAAC;EACJ;AACF","ignoreList":[]}