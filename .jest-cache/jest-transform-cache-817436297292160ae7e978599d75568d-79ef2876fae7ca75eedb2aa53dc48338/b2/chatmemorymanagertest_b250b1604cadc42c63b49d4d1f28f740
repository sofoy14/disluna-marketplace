0a0d2092c02b0ffdcf53879d7ffd83ad
"use strict";
/**
 * Tests de Regresión - ChatMemoryManager
 *
 * Tests críticos para asegurar que el sistema de memoria funciona correctamente
 * después de la refactorización, cumpliendo con requisitos de auditoría legal.
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock del cliente Supabase
jest.mock('@supabase/supabase-js', () => ({
    createClient: jest.fn(() => mockSupabaseClient)
}));
const chat_memory_manager_1 = require("../../lib/memory/chat-memory-manager");
// Mock de Supabase para tests
const mockSupabaseClient = {
    from: jest.fn(() => ({
        select: jest.fn(() => ({
            eq: jest.fn(() => ({
                order: jest.fn(() => ({
                    limit: jest.fn(() => Promise.resolve({ data: [], error: null }))
                }))
            }))
        })),
        insert: jest.fn(() => Promise.resolve({ data: [], error: null })),
        update: jest.fn(() => ({
            eq: jest.fn(() => Promise.resolve({ data: [], error: null }))
        })),
        upsert: jest.fn(() => Promise.resolve({ data: [], error: null }))
    }))
};
describe('ChatMemoryManager - Tests de Regresión', () => {
    let memoryManager;
    const testUserId = 'test-user-123';
    const testChatId = 'test-chat-456';
    beforeEach(() => {
        memoryManager = new chat_memory_manager_1.ChatMemoryManager();
        jest.clearAllMocks();
    });
    describe('Trazabilidad Completa', () => {
        test('debe registrar consulta del usuario correctamente', async () => {
            const userQuery = '¿Cuáles son los requisitos para constituir una empresa en Colombia?';
            await memoryManager.addMessage(testChatId, testUserId, {
                role: 'user',
                content: userQuery,
                timestamp: new Date()
            });
            // Verificar que se llamó insert con los datos correctos
            expect(mockSupabaseClient.from).toHaveBeenCalledWith('messages');
            expect(mockSupabaseClient.from().insert).toHaveBeenCalledWith(expect.objectContaining({
                chat_id: testChatId,
                user_id: testUserId,
                role: 'user',
                content: userQuery
            }));
        });
        test('debe registrar respuesta del asistente con fuentes', async () => {
            const assistantResponse = 'Para constituir una empresa en Colombia se requiere...';
            const sources = [
                {
                    title: 'Código de Comercio - Artículo 110',
                    url: 'https://www.suin-juriscol.gov.co/viewDocument.asp?ruta=Leyes/1689347',
                    type: 'official',
                    quality: 9
                }
            ];
            await memoryManager.addMessage(testChatId, testUserId, {
                role: 'assistant',
                content: assistantResponse,
                timestamp: new Date(),
                metadata: {
                    sources,
                    quality: 8.5,
                    verification: { passed: true, confidence: 0.9 },
                    mode: 'iter_research'
                }
            });
            // Verificar que se registraron las fuentes
            expect(mockSupabaseClient.from().insert).toHaveBeenCalledWith(expect.objectContaining({
                metadata: expect.objectContaining({
                    sources,
                    quality: 8.5,
                    verification: { passed: true, confidence: 0.9 },
                    mode: 'iter_research'
                })
            }));
        });
        test('debe registrar búsquedas realizadas', async () => {
            const searchQuery = 'constitución empresa Colombia requisitos';
            const searchResults = [
                {
                    title: 'Constitución de Empresas - DIAN',
                    url: 'https://www.dian.gov.co',
                    type: 'official',
                    quality: 8
                }
            ];
            await memoryManager.addSearchHistory(testChatId, testUserId, {
                query: searchQuery,
                results: searchResults,
                mode: 'legal_search',
                quality: 8,
                duration: 1500
            });
            // Verificar que se registró la búsqueda
            expect(mockSupabaseClient.from).toHaveBeenCalledWith('chat_contexts');
            expect(mockSupabaseClient.from().upsert).toHaveBeenCalled();
        });
    });
    describe('Cache de Fuentes', () => {
        test('debe cachear fuentes verificadas con TTL correcto', async () => {
            const source = {
                url: 'https://www.corteconstitucional.gov.co/relatoria/2024/',
                title: 'Sentencia T-123 de 2024',
                content: 'Contenido de la sentencia...',
                type: 'official',
                quality: 9,
                authority: 'maxima'
            };
            await memoryManager.cacheSource(testChatId, testUserId, source);
            // Verificar que se cacheó con TTL de 24 horas
            const expectedExpiry = new Date(Date.now() + 24 * 60 * 60 * 1000);
            expect(mockSupabaseClient.from().upsert).toHaveBeenCalledWith(expect.objectContaining({
                cached_sources: expect.arrayContaining([
                    expect.objectContaining({
                        ...source,
                        cachedAt: expect.any(Date),
                        expiresAt: expect.any(Date)
                    })
                ])
            }));
        });
        test('debe recuperar fuentes cacheadas válidas', async () => {
            const cachedSource = {
                url: 'https://www.suin-juriscol.gov.co',
                title: 'Código de Comercio',
                content: 'Contenido del código...',
                type: 'official',
                quality: 9,
                authority: 'maxima',
                cachedAt: new Date(Date.now() - 1000), // 1 segundo atrás
                expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000) // 24 horas en el futuro
            };
            // Mock de respuesta con fuente cacheada
            mockSupabaseClient.from().select().eq().order().limit.mockResolvedValueOnce({
                data: [{
                        cached_sources: [cachedSource]
                    }],
                error: null
            });
            const sources = await memoryManager.getCachedSources(testChatId, testUserId);
            expect(sources).toHaveLength(1);
            expect(sources[0]).toEqual(cachedSource);
        });
        test('debe excluir fuentes cacheadas expiradas', async () => {
            const expiredSource = {
                url: 'https://www.example.com',
                title: 'Fuente Expirada',
                content: 'Contenido...',
                type: 'general',
                quality: 5,
                authority: 'baja',
                cachedAt: new Date(Date.now() - 25 * 60 * 60 * 1000), // 25 horas atrás
                expiresAt: new Date(Date.now() - 60 * 60 * 1000) // 1 hora atrás (expirada)
            };
            // Mock de respuesta con fuente expirada
            mockSupabaseClient.from().select().eq().order().limit.mockResolvedValueOnce({
                data: [{
                        cached_sources: [expiredSource]
                    }],
                error: null
            });
            const sources = await memoryManager.getCachedSources(testChatId, testUserId);
            expect(sources).toHaveLength(0);
        });
    });
    describe('Métricas de Calidad', () => {
        test('debe calcular métricas de calidad correctamente', async () => {
            const mockContexts = [
                {
                    quality_metrics: {
                        totalQueries: 10,
                        averageQuality: 8.5,
                        modePerformance: {
                            react: { count: 3, avgQuality: 8.0, avgTime: 2000 },
                            iter_research: { count: 5, avgQuality: 9.0, avgTime: 5000 },
                            hybrid: { count: 2, avgQuality: 8.5, avgTime: 3500 }
                        },
                        verificationStats: {
                            totalVerifications: 10,
                            passedVerifications: 9,
                            averageConfidence: 0.9,
                            successRate: 0.9
                        }
                    },
                    search_history: [],
                    created_at: new Date().toISOString()
                }
            ];
            mockSupabaseClient.from().select().eq.mockResolvedValueOnce({
                data: mockContexts,
                error: null
            });
            const metrics = await memoryManager.getQualityMetrics(testUserId);
            expect(metrics.totalQueries).toBe(10);
            expect(metrics.averageQuality).toBe(8.5);
            expect(metrics.modePerformance.iter_research.count).toBe(5);
            expect(metrics.verificationStats.successRate).toBe(0.9);
            expect(metrics.topPerformingMode).toBe('iter_research');
        });
        test('debe generar recomendaciones basadas en métricas', async () => {
            const mockContexts = [
                {
                    quality_metrics: {
                        totalQueries: 5,
                        averageQuality: 6.0, // Calidad baja
                        modePerformance: {
                            react: { count: 2, avgQuality: 5.0, avgTime: 1500 },
                            iter_research: { count: 2, avgQuality: 7.0, avgTime: 4000 },
                            hybrid: { count: 1, avgQuality: 6.0, avgTime: 3000 }
                        },
                        verificationStats: {
                            totalVerifications: 5,
                            passedVerifications: 3, // Tasa baja
                            averageConfidence: 0.6,
                            successRate: 0.6
                        }
                    },
                    search_history: [],
                    created_at: new Date().toISOString()
                }
            ];
            mockSupabaseClient.from().select().eq.mockResolvedValueOnce({
                data: mockContexts,
                error: null
            });
            const metrics = await memoryManager.getQualityMetrics(testUserId);
            expect(metrics.recommendations).toContain(expect.stringContaining('mejorar calidad'));
            expect(metrics.recommendations).toContain(expect.stringContaining('verificación'));
        });
    });
    describe('Construcción de Contexto', () => {
        test('debe construir contexto actual correctamente', async () => {
            const mockMessages = [
                {
                    role: 'user',
                    content: 'Consulta sobre constitución de empresa',
                    timestamp: new Date().toISOString()
                },
                {
                    role: 'assistant',
                    content: 'Respuesta sobre constitución...',
                    timestamp: new Date().toISOString(),
                    metadata: {
                        sources: [{ title: 'Fuente 1', url: 'https://example.com' }],
                        quality: 8
                    }
                }
            ];
            const mockContext = {
                chatId: testChatId,
                userId: testUserId,
                conversationHistory: mockMessages,
                searchHistory: [],
                cachedSources: [],
                userPreferences: {
                    preferredSearchStrategy: 'AGENTE_UNIFICADO_TONGYI',
                    maxSearchRounds: 8,
                    enableModelDecision: true
                },
                qualityMetrics: {
                    totalQueries: 1,
                    averageQuality: 8,
                    modePerformance: {
                        react: { count: 0, avgQuality: 0, avgTime: 0 },
                        iter_research: { count: 1, avgQuality: 8, avgTime: 3000 },
                        hybrid: { count: 0, avgQuality: 0, avgTime: 0 }
                    },
                    verificationStats: {
                        totalVerifications: 1,
                        passedVerifications: 1,
                        averageConfidence: 0.9,
                        successRate: 1.0
                    }
                }
            };
            mockSupabaseClient.from().select().eq().order().limit.mockResolvedValueOnce({
                data: mockMessages,
                error: null
            });
            mockSupabaseClient.from().select().eq.mockResolvedValueOnce({
                data: [mockContext],
                error: null
            });
            const context = await memoryManager.getChatContext(testChatId, testUserId);
            expect(context.conversationHistory).toHaveLength(2);
            expect(context.currentContext).toContain('Consulta sobre constitución');
            expect(context.currentContext).toContain('Respuesta sobre constitución');
        });
    });
    describe('Manejo de Errores', () => {
        test('debe manejar errores de base de datos gracefully', async () => {
            mockSupabaseClient.from().insert.mockResolvedValueOnce({
                data: null,
                error: { message: 'Database connection failed' }
            });
            // No debe lanzar excepción
            await expect(memoryManager.addMessage(testChatId, testUserId, {
                role: 'user',
                content: 'Test message',
                timestamp: new Date()
            })).resolves.not.toThrow();
        });
        test('debe retornar métricas por defecto en caso de error', async () => {
            mockSupabaseClient.from().select().eq.mockResolvedValueOnce({
                data: null,
                error: { message: 'Query failed' }
            });
            const metrics = await memoryManager.getQualityMetrics(testUserId);
            expect(metrics.totalQueries).toBe(0);
            expect(metrics.averageQuality).toBe(0);
            expect(metrics.topPerformingMode).toBe('react');
        });
    });
    describe('Cumplimiento Legal', () => {
        test('debe registrar información suficiente para auditoría', async () => {
            const auditData = {
                query: 'Consulta legal específica',
                response: 'Respuesta legal detallada',
                sources: [
                    {
                        title: 'Ley 123 de 2024',
                        url: 'https://www.imprenta.gov.co',
                        type: 'official',
                        quality: 9,
                        authority: 'maxima'
                    }
                ],
                verification: {
                    passed: true,
                    confidence: 0.95,
                    checks: ['source_validation', 'fact_checking', 'legal_reference']
                },
                timestamp: new Date(),
                userId: testUserId,
                chatId: testChatId
            };
            await memoryManager.addMessage(testChatId, testUserId, {
                role: 'assistant',
                content: auditData.response,
                timestamp: auditData.timestamp,
                metadata: {
                    sources: auditData.sources,
                    verification: auditData.verification,
                    quality: 9
                }
            });
            // Verificar que se registró toda la información necesaria para auditoría
            expect(mockSupabaseClient.from().insert).toHaveBeenCalledWith(expect.objectContaining({
                chat_id: auditData.chatId,
                user_id: auditData.userId,
                content: auditData.response,
                metadata: expect.objectContaining({
                    sources: auditData.sources,
                    verification: auditData.verification,
                    quality: 9
                })
            }));
        });
        test('debe permitir eliminación de datos para GDPR', async () => {
            await memoryManager.clearChatMemory(testUserId, testChatId);
            // Verificar que se llamaron las operaciones de eliminación
            expect(mockSupabaseClient.from).toHaveBeenCalledWith('messages');
            expect(mockSupabaseClient.from).toHaveBeenCalledWith('chat_contexts');
        });
    });
});
describe('ChatMemoryManager - Tests de Integración', () => {
    let memoryManager;
    const testUserId = 'integration-test-user';
    const testChatId = 'integration-test-chat';
    beforeEach(() => {
        memoryManager = new chat_memory_manager_1.ChatMemoryManager();
    });
    test('debe mantener consistencia de datos en operaciones complejas', async () => {
        // Simular flujo completo de consulta legal
        const userQuery = '¿Cuáles son los pasos para constituir una SAS?';
        // 1. Registrar consulta del usuario
        await memoryManager.addMessage(testChatId, testUserId, {
            role: 'user',
            content: userQuery,
            timestamp: new Date()
        });
        // 2. Registrar búsquedas realizadas
        await memoryManager.addSearchHistory(testChatId, testUserId, {
            query: 'constitución SAS Colombia requisitos',
            results: [
                {
                    title: 'Código de Comercio - Artículo 110',
                    url: 'https://www.suin-juriscol.gov.co',
                    type: 'official',
                    quality: 9
                }
            ],
            mode: 'legal_search',
            quality: 9,
            duration: 2000
        });
        // 3. Cachear fuente encontrada
        await memoryManager.cacheSource(testChatId, testUserId, {
            url: 'https://www.suin-juriscol.gov.co',
            title: 'Código de Comercio - Artículo 110',
            content: 'Contenido del artículo...',
            type: 'official',
            quality: 9,
            authority: 'maxima'
        });
        // 4. Registrar respuesta del asistente
        await memoryManager.addMessage(testChatId, testUserId, {
            role: 'assistant',
            content: 'Para constituir una SAS en Colombia...',
            timestamp: new Date(),
            metadata: {
                sources: [
                    {
                        title: 'Código de Comercio - Artículo 110',
                        url: 'https://www.suin-juriscol.gov.co',
                        type: 'official',
                        quality: 9,
                        authority: 'maxima'
                    }
                ],
                quality: 9,
                verification: { passed: true, confidence: 0.95 },
                mode: 'iter_research'
            }
        });
        // 5. Verificar que todas las operaciones se registraron
        expect(mockSupabaseClient.from).toHaveBeenCalledTimes(6); // 2 mensajes + 1 búsqueda + 1 cache + 2 contextos
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxwZWRyb1xcRG9jdW1lbnRzXFxHaXRIdWJcXEFzaXN0ZW50ZS1MZWdhbC1JbnRlbGlnZW50ZVxcX190ZXN0c19fXFxsaWJcXG1lbW9yeVxcY2hhdC1tZW1vcnktbWFuYWdlci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7QUF1QkgsNEJBQTRCO0FBQzVCLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN4QyxZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQztDQUNoRCxDQUFDLENBQUMsQ0FBQTtBQXhCSCw4RUFBd0U7QUFHeEUsOEJBQThCO0FBQzlCLE1BQU0sa0JBQWtCLEdBQUc7SUFDekIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNuQixNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQ3JCLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7Z0JBQ2pCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7b0JBQ3BCLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO2lCQUNqRSxDQUFDLENBQUM7YUFDSixDQUFDLENBQUM7U0FDSixDQUFDLENBQUM7UUFDSCxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNqRSxNQUFNLEVBQUUs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TUFBTSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFO2dCQUNoRCxJQUFJLEVBQUUsZUFBZTthQUN0QjtTQUNGLENBQUMsQ0FBQTtRQUVGLHdEQUF3RDtRQUN4RCxNQUFNLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBQyxrREFBa0Q7SUFDN0csQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHBlZHJvXFxEb2N1bWVudHNcXEdpdEh1YlxcQXNpc3RlbnRlLUxlZ2FsLUludGVsaWdlbnRlXFxfX3Rlc3RzX19cXGxpYlxcbWVtb3J5XFxjaGF0LW1lbW9yeS1tYW5hZ2VyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFRlc3RzIGRlIFJlZ3Jlc2nDs24gLSBDaGF0TWVtb3J5TWFuYWdlclxyXG4gKiBcclxuICogVGVzdHMgY3LDrXRpY29zIHBhcmEgYXNlZ3VyYXIgcXVlIGVsIHNpc3RlbWEgZGUgbWVtb3JpYSBmdW5jaW9uYSBjb3JyZWN0YW1lbnRlXHJcbiAqIGRlc3B1w6lzIGRlIGxhIHJlZmFjdG9yaXphY2nDs24sIGN1bXBsaWVuZG8gY29uIHJlcXVpc2l0b3MgZGUgYXVkaXRvcsOtYSBsZWdhbC5cclxuICovXHJcblxyXG5pbXBvcnQgeyBDaGF0TWVtb3J5TWFuYWdlciB9IGZyb20gJy4uLy4uL2xpYi9tZW1vcnkvY2hhdC1tZW1vcnktbWFuYWdlcidcclxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xyXG5cclxuLy8gTW9jayBkZSBTdXBhYmFzZSBwYXJhIHRlc3RzXHJcbmNvbnN0IG1vY2tTdXBhYmFzZUNsaWVudCA9IHtcclxuICBmcm9tOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICBzZWxlY3Q6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgZXE6IGplc3QuZm4oKCkgPT4gKHtcclxuICAgICAgICBvcmRlcjogamVzdC5mbigoKSA9PiAoe1xyXG4gICAgICAgICAgbGltaXQ6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgZGF0YTogW10sIGVycm9yOiBudWxsIH0pKVxyXG4gICAgICAgIH0pKVxyXG4gICAgICB9KSlcclxuICAgIH0pKSxcclxuICAgIGluc2VydDogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbXSwgZXJyb3I6IG51bGwgfSkpLFxyXG4gICAgdXBkYXRlOiBqZXN0LmZuKCgpID0+ICh7XHJcbiAgICAgIGVxOiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSh7IGRhdGE6IFtdLCBlcnJvcjogbnVsbCB9KSlcclxuICAgIH0pKSxcclxuICAgIHVwc2VydDogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBkYXRhOiBbXSwgZXJyb3I6IG51bGwgfSkpXHJcbiAgfSkpXHJcbn1cclxuXHJcbi8vIE1vY2sgZGVsIGNsaWVudGUgU3VwYWJhc2VcclxuamVzdC5tb2NrKCdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnLCAoKSA9PiAoe1xyXG4gIGNyZWF0ZUNsaWVudDogamVzdC5mbigoKSA9PiBtb2NrU3VwYWJhc2VDbGllbnQpXHJcbn0pKVxyXG5cclxuZGVzY3JpYmUoJ0NoYXRNZW1vcnlNYW5hZ2VyIC0gVGVzdHMgZGUgUmVncmVzacOzbicsICgpID0+IHtcclxuICBsZXQgbWVtb3J5TWFuYWdlcjogQ2hhdE1lbW9yeU1hbmFnZXJcclxuICBjb25zdCB0ZXN0VXNlcklkID0gJ3Rlc3QtdXNlci0xMjMnXHJcbiAgY29uc3QgdGVzdENoYXRJZCA9ICd0ZXN0LWNoYXQtNDU2J1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIG1lbW9yeU1hbmFnZXIgPSBuZXcgQ2hhdE1lbW9yeU1hbmFnZXIoKVxyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKClcclxuICB9KVxyXG5cclxuICBkZXNjcmliZSgnVHJhemFiaWxpZGFkIENvbXBsZXRhJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnZGViZSByZWdpc3RyYXIgY29uc3VsdGEgZGVsIHVzdWFyaW8gY29ycmVjdGFtZW50ZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgdXNlclF1ZXJ5ID0gJ8K/Q3XDoWxlcyBzb24gbG9zIHJlcXVpc2l0b3MgcGFyYSBjb25zdGl0dWlyIHVuYSBlbXByZXNhIGVuIENvbG9tYmlhPydcclxuICAgICAgXHJcbiAgICAgIGF3YWl0IG1lbW9yeU1hbmFnZXIuYWRkTWVzc2FnZSh0ZXN0Q2hhdElkLCB0ZXN0VXNlcklkLCB7XHJcbiAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgIGNvbnRlbnQ6IHVzZXJRdWVyeSxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhciBxdWUgc2UgbGxhbcOzIGluc2VydCBjb24gbG9zIGRhdG9zIGNvcnJlY3Rvc1xyXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmZyb20pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdtZXNzYWdlcycpXHJcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLmluc2VydCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgY2hhdF9pZDogdGVzdENoYXRJZCxcclxuICAgICAgICAgIHVzZXJfaWQ6IHRlc3RVc2VySWQsXHJcbiAgICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgICBjb250ZW50OiB1c2VyUXVlcnlcclxuICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRlc3QoJ2RlYmUgcmVnaXN0cmFyIHJlc3B1ZXN0YSBkZWwgYXNpc3RlbnRlIGNvbiBmdWVudGVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBhc3Npc3RhbnRSZXNwb25zZSA9ICdQYXJhIGNvbnN0aXR1aXIgdW5hIGVtcHJlc2EgZW4gQ29sb21iaWEgc2UgcmVxdWllcmUuLi4nXHJcbiAgICAgIGNvbnN0IHNvdXJjZXMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGl0bGU6ICdDw7NkaWdvIGRlIENvbWVyY2lvIC0gQXJ0w61jdWxvIDExMCcsXHJcbiAgICAgICAgICB1cmw6ICdodHRwczovL3d3dy5zdWluLWp1cmlzY29sLmdvdi5jby92aWV3RG9jdW1lbnQuYXNwP3J1dGE9TGV5ZXMvMTY4OTM0NycsXHJcbiAgICAgICAgICB0eXBlOiAnb2ZmaWNpYWwnLFxyXG4gICAgICAgICAgcXVhbGl0eTogOVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG5cclxuICAgICAgYXdhaXQgbWVtb3J5TWFuYWdlci5hZGRNZXNzYWdlKHRlc3RDaGF0SWQsIHRlc3RVc2VySWQsIHtcclxuICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcclxuICAgICAgICBjb250ZW50OiBhc3Npc3RhbnRSZXNwb25zZSxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgIHNvdXJjZXMsXHJcbiAgICAgICAgICBxdWFsaXR5OiA4LjUsXHJcbiAgICAgICAgICB2ZXJpZmljYXRpb246IHsgcGFzc2VkOiB0cnVlLCBjb25maWRlbmNlOiAwLjkgfSxcclxuICAgICAgICAgIG1vZGU6ICdpdGVyX3Jlc2VhcmNoJ1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhciBxdWUgc2UgcmVnaXN0cmFyb24gbGFzIGZ1ZW50ZXNcclxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKCkuaW5zZXJ0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICBtZXRhZGF0YTogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgICBzb3VyY2VzLFxyXG4gICAgICAgICAgICBxdWFsaXR5OiA4LjUsXHJcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbjogeyBwYXNzZWQ6IHRydWUsIGNvbmZpZGVuY2U6IDAuOSB9LFxyXG4gICAgICAgICAgICBtb2RlOiAnaXRlcl9yZXNlYXJjaCdcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICB0ZXN0KCdkZWJlIHJlZ2lzdHJhciBiw7pzcXVlZGFzIHJlYWxpemFkYXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gJ2NvbnN0aXR1Y2nDs24gZW1wcmVzYSBDb2xvbWJpYSByZXF1aXNpdG9zJ1xyXG4gICAgICBjb25zdCBzZWFyY2hSZXN1bHRzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIHRpdGxlOiAnQ29uc3RpdHVjacOzbiBkZSBFbXByZXNhcyAtIERJQU4nLFxyXG4gICAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuZGlhbi5nb3YuY28nLFxyXG4gICAgICAgICAgdHlwZTogJ29mZmljaWFsJyxcclxuICAgICAgICAgIHF1YWxpdHk6IDhcclxuICAgICAgICB9XHJcbiAgICAgIF1cclxuXHJcbiAgICAgIGF3YWl0IG1lbW9yeU1hbmFnZXIuYWRkU2VhcmNoSGlzdG9yeSh0ZXN0Q2hhdElkLCB0ZXN0VXNlcklkLCB7XHJcbiAgICAgICAgcXVlcnk6IHNlYXJjaFF1ZXJ5LFxyXG4gICAgICAgIHJlc3VsdHM6IHNlYXJjaFJlc3VsdHMsXHJcbiAgICAgICAgbW9kZTogJ2xlZ2FsX3NlYXJjaCcsXHJcbiAgICAgICAgcXVhbGl0eTogOCxcclxuICAgICAgICBkdXJhdGlvbjogMTUwMFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8gVmVyaWZpY2FyIHF1ZSBzZSByZWdpc3Ryw7MgbGEgYsO6c3F1ZWRhXHJcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2NoYXRfY29udGV4dHMnKVxyXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmZyb20oKS51cHNlcnQpLnRvSGF2ZUJlZW5DYWxsZWQoKVxyXG4gICAgfSlcclxuICB9KVxyXG5cclxuICBkZXNjcmliZSgnQ2FjaGUgZGUgRnVlbnRlcycsICgpID0+IHtcclxuICAgIHRlc3QoJ2RlYmUgY2FjaGVhciBmdWVudGVzIHZlcmlmaWNhZGFzIGNvbiBUVEwgY29ycmVjdG8nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvdXJjZSA9IHtcclxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5jb3J0ZWNvbnN0aXR1Y2lvbmFsLmdvdi5jby9yZWxhdG9yaWEvMjAyNC8nLFxyXG4gICAgICAgIHRpdGxlOiAnU2VudGVuY2lhIFQtMTIzIGRlIDIwMjQnLFxyXG4gICAgICAgIGNvbnRlbnQ6ICdDb250ZW5pZG8gZGUgbGEgc2VudGVuY2lhLi4uJyxcclxuICAgICAgICB0eXBlOiAnb2ZmaWNpYWwnIGFzIGNvbnN0LFxyXG4gICAgICAgIHF1YWxpdHk6IDksXHJcbiAgICAgICAgYXV0aG9yaXR5OiAnbWF4aW1hJyBhcyBjb25zdFxyXG4gICAgICB9XHJcblxyXG4gICAgICBhd2FpdCBtZW1vcnlNYW5hZ2VyLmNhY2hlU291cmNlKHRlc3RDaGF0SWQsIHRlc3RVc2VySWQsIHNvdXJjZSlcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhciBxdWUgc2UgY2FjaGXDsyBjb24gVFRMIGRlIDI0IGhvcmFzXHJcbiAgICAgIGNvbnN0IGV4cGVjdGVkRXhwaXJ5ID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDApXHJcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnVwc2VydCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xyXG4gICAgICAgICAgY2FjaGVkX3NvdXJjZXM6IGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW1xyXG4gICAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XHJcbiAgICAgICAgICAgICAgLi4uc291cmNlLFxyXG4gICAgICAgICAgICAgIGNhY2hlZEF0OiBleHBlY3QuYW55KERhdGUpLFxyXG4gICAgICAgICAgICAgIGV4cGlyZXNBdDogZXhwZWN0LmFueShEYXRlKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgXSlcclxuICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRlc3QoJ2RlYmUgcmVjdXBlcmFyIGZ1ZW50ZXMgY2FjaGVhZGFzIHbDoWxpZGFzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjYWNoZWRTb3VyY2UgPSB7XHJcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuc3Vpbi1qdXJpc2NvbC5nb3YuY28nLFxyXG4gICAgICAgIHRpdGxlOiAnQ8OzZGlnbyBkZSBDb21lcmNpbycsXHJcbiAgICAgICAgY29udGVudDogJ0NvbnRlbmlkbyBkZWwgY8OzZGlnby4uLicsXHJcbiAgICAgICAgdHlwZTogJ29mZmljaWFsJyBhcyBjb25zdCxcclxuICAgICAgICBxdWFsaXR5OiA5LFxyXG4gICAgICAgIGF1dGhvcml0eTogJ21heGltYScgYXMgY29uc3QsXHJcbiAgICAgICAgY2FjaGVkQXQ6IG5ldyBEYXRlKERhdGUubm93KCkgLSAxMDAwKSwgLy8gMSBzZWd1bmRvIGF0csOhc1xyXG4gICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDApIC8vIDI0IGhvcmFzIGVuIGVsIGZ1dHVyb1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBNb2NrIGRlIHJlc3B1ZXN0YSBjb24gZnVlbnRlIGNhY2hlYWRhXHJcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tKCkuc2VsZWN0KCkuZXEoKS5vcmRlcigpLmxpbWl0Lm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XHJcbiAgICAgICAgZGF0YTogW3tcclxuICAgICAgICAgIGNhY2hlZF9zb3VyY2VzOiBbY2FjaGVkU291cmNlXVxyXG4gICAgICAgIH1dLFxyXG4gICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBjb25zdCBzb3VyY2VzID0gYXdhaXQgbWVtb3J5TWFuYWdlci5nZXRDYWNoZWRTb3VyY2VzKHRlc3RDaGF0SWQsIHRlc3RVc2VySWQpXHJcblxyXG4gICAgICBleHBlY3Qoc291cmNlcykudG9IYXZlTGVuZ3RoKDEpXHJcbiAgICAgIGV4cGVjdChzb3VyY2VzWzBdKS50b0VxdWFsKGNhY2hlZFNvdXJjZSlcclxuICAgIH0pXHJcblxyXG4gICAgdGVzdCgnZGViZSBleGNsdWlyIGZ1ZW50ZXMgY2FjaGVhZGFzIGV4cGlyYWRhcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXhwaXJlZFNvdXJjZSA9IHtcclxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbScsXHJcbiAgICAgICAgdGl0bGU6ICdGdWVudGUgRXhwaXJhZGEnLFxyXG4gICAgICAgIGNvbnRlbnQ6ICdDb250ZW5pZG8uLi4nLFxyXG4gICAgICAgIHR5cGU6ICdnZW5lcmFsJyBhcyBjb25zdCxcclxuICAgICAgICBxdWFsaXR5OiA1LFxyXG4gICAgICAgIGF1dGhvcml0eTogJ2JhamEnIGFzIGNvbnN0LFxyXG4gICAgICAgIGNhY2hlZEF0OiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMjUgKiA2MCAqIDYwICogMTAwMCksIC8vIDI1IGhvcmFzIGF0csOhc1xyXG4gICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDYwICogNjAgKiAxMDAwKSAvLyAxIGhvcmEgYXRyw6FzIChleHBpcmFkYSlcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gTW9jayBkZSByZXNwdWVzdGEgY29uIGZ1ZW50ZSBleHBpcmFkYVxyXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnNlbGVjdCgpLmVxKCkub3JkZXIoKS5saW1pdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIGRhdGE6IFt7XHJcbiAgICAgICAgICBjYWNoZWRfc291cmNlczogW2V4cGlyZWRTb3VyY2VdXHJcbiAgICAgICAgfV0sXHJcbiAgICAgICAgZXJyb3I6IG51bGxcclxuICAgICAgfSlcclxuXHJcbiAgICAgIGNvbnN0IHNvdXJjZXMgPSBhd2FpdCBtZW1vcnlNYW5hZ2VyLmdldENhY2hlZFNvdXJjZXModGVzdENoYXRJZCwgdGVzdFVzZXJJZClcclxuXHJcbiAgICAgIGV4cGVjdChzb3VyY2VzKS50b0hhdmVMZW5ndGgoMClcclxuICAgIH0pXHJcbiAgfSlcclxuXHJcbiAgZGVzY3JpYmUoJ03DqXRyaWNhcyBkZSBDYWxpZGFkJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnZGViZSBjYWxjdWxhciBtw6l0cmljYXMgZGUgY2FsaWRhZCBjb3JyZWN0YW1lbnRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrQ29udGV4dHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcXVhbGl0eV9tZXRyaWNzOiB7XHJcbiAgICAgICAgICAgIHRvdGFsUXVlcmllczogMTAsXHJcbiAgICAgICAgICAgIGF2ZXJhZ2VRdWFsaXR5OiA4LjUsXHJcbiAgICAgICAgICAgIG1vZGVQZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgICAgIHJlYWN0OiB7IGNvdW50OiAzLCBhdmdRdWFsaXR5OiA4LjAsIGF2Z1RpbWU6IDIwMDAgfSxcclxuICAgICAgICAgICAgICBpdGVyX3Jlc2VhcmNoOiB7IGNvdW50OiA1LCBhdmdRdWFsaXR5OiA5LjAsIGF2Z1RpbWU6IDUwMDAgfSxcclxuICAgICAgICAgICAgICBoeWJyaWQ6IHsgY291bnQ6IDIsIGF2Z1F1YWxpdHk6IDguNSwgYXZnVGltZTogMzUwMCB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblN0YXRzOiB7XHJcbiAgICAgICAgICAgICAgdG90YWxWZXJpZmljYXRpb25zOiAxMCxcclxuICAgICAgICAgICAgICBwYXNzZWRWZXJpZmljYXRpb25zOiA5LFxyXG4gICAgICAgICAgICAgIGF2ZXJhZ2VDb25maWRlbmNlOiAwLjksXHJcbiAgICAgICAgICAgICAgc3VjY2Vzc1JhdGU6IDAuOVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VhcmNoX2hpc3Rvcnk6IFtdLFxyXG4gICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcblxyXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnNlbGVjdCgpLmVxLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XHJcbiAgICAgICAgZGF0YTogbW9ja0NvbnRleHRzLFxyXG4gICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbWVtb3J5TWFuYWdlci5nZXRRdWFsaXR5TWV0cmljcyh0ZXN0VXNlcklkKVxyXG5cclxuICAgICAgZXhwZWN0KG1ldHJpY3MudG90YWxRdWVyaWVzKS50b0JlKDEwKVxyXG4gICAgICBleHBlY3QobWV0cmljcy5hdmVyYWdlUXVhbGl0eSkudG9CZSg4LjUpXHJcbiAgICAgIGV4cGVjdChtZXRyaWNzLm1vZGVQZXJmb3JtYW5jZS5pdGVyX3Jlc2VhcmNoLmNvdW50KS50b0JlKDUpXHJcbiAgICAgIGV4cGVjdChtZXRyaWNzLnZlcmlmaWNhdGlvblN0YXRzLnN1Y2Nlc3NSYXRlKS50b0JlKDAuOSlcclxuICAgICAgZXhwZWN0KG1ldHJpY3MudG9wUGVyZm9ybWluZ01vZGUpLnRvQmUoJ2l0ZXJfcmVzZWFyY2gnKVxyXG4gICAgfSlcclxuXHJcbiAgICB0ZXN0KCdkZWJlIGdlbmVyYXIgcmVjb21lbmRhY2lvbmVzIGJhc2FkYXMgZW4gbcOpdHJpY2FzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrQ29udGV4dHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcXVhbGl0eV9tZXRyaWNzOiB7XHJcbiAgICAgICAgICAgIHRvdGFsUXVlcmllczogNSxcclxuICAgICAgICAgICAgYXZlcmFnZVF1YWxpdHk6IDYuMCwgLy8gQ2FsaWRhZCBiYWphXHJcbiAgICAgICAgICAgIG1vZGVQZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgICAgIHJlYWN0OiB7IGNvdW50OiAyLCBhdmdRdWFsaXR5OiA1LjAsIGF2Z1RpbWU6IDE1MDAgfSxcclxuICAgICAgICAgICAgICBpdGVyX3Jlc2VhcmNoOiB7IGNvdW50OiAyLCBhdmdRdWFsaXR5OiA3LjAsIGF2Z1RpbWU6IDQwMDAgfSxcclxuICAgICAgICAgICAgICBoeWJyaWQ6IHsgY291bnQ6IDEsIGF2Z1F1YWxpdHk6IDYuMCwgYXZnVGltZTogMzAwMCB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvblN0YXRzOiB7XHJcbiAgICAgICAgICAgICAgdG90YWxWZXJpZmljYXRpb25zOiA1LFxyXG4gICAgICAgICAgICAgIHBhc3NlZFZlcmlmaWNhdGlvbnM6IDMsIC8vIFRhc2EgYmFqYVxyXG4gICAgICAgICAgICAgIGF2ZXJhZ2VDb25maWRlbmNlOiAwLjYsXHJcbiAgICAgICAgICAgICAgc3VjY2Vzc1JhdGU6IDAuNlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2VhcmNoX2hpc3Rvcnk6IFtdLFxyXG4gICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcblxyXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnNlbGVjdCgpLmVxLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XHJcbiAgICAgICAgZGF0YTogbW9ja0NvbnRleHRzLFxyXG4gICAgICAgIGVycm9yOiBudWxsXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICBjb25zdCBtZXRyaWNzID0gYXdhaXQgbWVtb3J5TWFuYWdlci5nZXRRdWFsaXR5TWV0cmljcyh0ZXN0VXNlcklkKVxyXG5cclxuICAgICAgZXhwZWN0KG1ldHJpY3MucmVjb21tZW5kYXRpb25zKS50b0NvbnRhaW4oXHJcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ21lam9yYXIgY2FsaWRhZCcpXHJcbiAgICAgIClcclxuICAgICAgZXhwZWN0KG1ldHJpY3MucmVjb21tZW5kYXRpb25zKS50b0NvbnRhaW4oXHJcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ3ZlcmlmaWNhY2nDs24nKVxyXG4gICAgICApXHJcbiAgICB9KVxyXG4gIH0pXHJcblxyXG4gIGRlc2NyaWJlKCdDb25zdHJ1Y2Npw7NuIGRlIENvbnRleHRvJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnZGViZSBjb25zdHJ1aXIgY29udGV4dG8gYWN0dWFsIGNvcnJlY3RhbWVudGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tNZXNzYWdlcyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICByb2xlOiAndXNlcicsXHJcbiAgICAgICAgICBjb250ZW50OiAnQ29uc3VsdGEgc29icmUgY29uc3RpdHVjacOzbiBkZSBlbXByZXNhJyxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcclxuICAgICAgICAgIGNvbnRlbnQ6ICdSZXNwdWVzdGEgc29icmUgY29uc3RpdHVjacOzbi4uLicsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgIHNvdXJjZXM6IFt7IHRpdGxlOiAnRnVlbnRlIDEnLCB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tJyB9XSxcclxuICAgICAgICAgICAgcXVhbGl0eTogOFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgXVxyXG5cclxuICAgICAgY29uc3QgbW9ja0NvbnRleHQgPSB7XHJcbiAgICAgICAgY2hhdElkOiB0ZXN0Q2hhdElkLFxyXG4gICAgICAgIHVzZXJJZDogdGVzdFVzZXJJZCxcclxuICAgICAgICBjb252ZXJzYXRpb25IaXN0b3J5OiBtb2NrTWVzc2FnZXMsXHJcbiAgICAgICAgc2VhcmNoSGlzdG9yeTogW10sXHJcbiAgICAgICAgY2FjaGVkU291cmNlczogW10sXHJcbiAgICAgICAgdXNlclByZWZlcmVuY2VzOiB7XHJcbiAgICAgICAgICBwcmVmZXJyZWRTZWFyY2hTdHJhdGVneTogJ0FHRU5URV9VTklGSUNBRE9fVE9OR1lJJyxcclxuICAgICAgICAgIG1heFNlYXJjaFJvdW5kczogOCxcclxuICAgICAgICAgIGVuYWJsZU1vZGVsRGVjaXNpb246IHRydWVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHF1YWxpdHlNZXRyaWNzOiB7XHJcbiAgICAgICAgICB0b3RhbFF1ZXJpZXM6IDEsXHJcbiAgICAgICAgICBhdmVyYWdlUXVhbGl0eTogOCxcclxuICAgICAgICAgIG1vZGVQZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgICByZWFjdDogeyBjb3VudDogMCwgYXZnUXVhbGl0eTogMCwgYXZnVGltZTogMCB9LFxyXG4gICAgICAgICAgICBpdGVyX3Jlc2VhcmNoOiB7IGNvdW50OiAxLCBhdmdRdWFsaXR5OiA4LCBhdmdUaW1lOiAzMDAwIH0sXHJcbiAgICAgICAgICAgIGh5YnJpZDogeyBjb3VudDogMCwgYXZnUXVhbGl0eTogMCwgYXZnVGltZTogMCB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgdmVyaWZpY2F0aW9uU3RhdHM6IHtcclxuICAgICAgICAgICAgdG90YWxWZXJpZmljYXRpb25zOiAxLFxyXG4gICAgICAgICAgICBwYXNzZWRWZXJpZmljYXRpb25zOiAxLFxyXG4gICAgICAgICAgICBhdmVyYWdlQ29uZmlkZW5jZTogMC45LFxyXG4gICAgICAgICAgICBzdWNjZXNzUmF0ZTogMS4wXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLnNlbGVjdCgpLmVxKCkub3JkZXIoKS5saW1pdC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIGRhdGE6IG1vY2tNZXNzYWdlcyxcclxuICAgICAgICBlcnJvcjogbnVsbFxyXG4gICAgICB9KVxyXG5cclxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmZyb20oKS5zZWxlY3QoKS5lcS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIGRhdGE6IFttb2NrQ29udGV4dF0sXHJcbiAgICAgICAgZXJyb3I6IG51bGxcclxuICAgICAgfSlcclxuXHJcbiAgICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCBtZW1vcnlNYW5hZ2VyLmdldENoYXRDb250ZXh0KHRlc3RDaGF0SWQsIHRlc3RVc2VySWQpXHJcblxyXG4gICAgICBleHBlY3QoY29udGV4dC5jb252ZXJzYXRpb25IaXN0b3J5KS50b0hhdmVMZW5ndGgoMilcclxuICAgICAgZXhwZWN0KGNvbnRleHQuY3VycmVudENvbnRleHQpLnRvQ29udGFpbignQ29uc3VsdGEgc29icmUgY29uc3RpdHVjacOzbicpXHJcbiAgICAgIGV4cGVjdChjb250ZXh0LmN1cnJlbnRDb250ZXh0KS50b0NvbnRhaW4oJ1Jlc3B1ZXN0YSBzb2JyZSBjb25zdGl0dWNpw7NuJylcclxuICAgIH0pXHJcbiAgfSlcclxuXHJcbiAgZGVzY3JpYmUoJ01hbmVqbyBkZSBFcnJvcmVzJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnZGViZSBtYW5lamFyIGVycm9yZXMgZGUgYmFzZSBkZSBkYXRvcyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSgpLmluc2VydC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJyB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBObyBkZWJlIGxhbnphciBleGNlcGNpw7NuXHJcbiAgICAgIGF3YWl0IGV4cGVjdChcclxuICAgICAgICBtZW1vcnlNYW5hZ2VyLmFkZE1lc3NhZ2UodGVzdENoYXRJZCwgdGVzdFVzZXJJZCwge1xyXG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgY29udGVudDogJ1Rlc3QgbWVzc2FnZScsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcclxuICAgICAgICB9KVxyXG4gICAgICApLnJlc29sdmVzLm5vdC50b1Rocm93KClcclxuICAgIH0pXHJcblxyXG4gICAgdGVzdCgnZGViZSByZXRvcm5hciBtw6l0cmljYXMgcG9yIGRlZmVjdG8gZW4gY2FzbyBkZSBlcnJvcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmZyb20oKS5zZWxlY3QoKS5lcS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIGRhdGE6IG51bGwsXHJcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ1F1ZXJ5IGZhaWxlZCcgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc3QgbWV0cmljcyA9IGF3YWl0IG1lbW9yeU1hbmFnZXIuZ2V0UXVhbGl0eU1ldHJpY3ModGVzdFVzZXJJZClcclxuXHJcbiAgICAgIGV4cGVjdChtZXRyaWNzLnRvdGFsUXVlcmllcykudG9CZSgwKVxyXG4gICAgICBleHBlY3QobWV0cmljcy5hdmVyYWdlUXVhbGl0eSkudG9CZSgwKVxyXG4gICAgICBleHBlY3QobWV0cmljcy50b3BQZXJmb3JtaW5nTW9kZSkudG9CZSgncmVhY3QnKVxyXG4gICAgfSlcclxuICB9KVxyXG5cclxuICBkZXNjcmliZSgnQ3VtcGxpbWllbnRvIExlZ2FsJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnZGViZSByZWdpc3RyYXIgaW5mb3JtYWNpw7NuIHN1ZmljaWVudGUgcGFyYSBhdWRpdG9yw61hJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBhdWRpdERhdGEgPSB7XHJcbiAgICAgICAgcXVlcnk6ICdDb25zdWx0YSBsZWdhbCBlc3BlY8OtZmljYScsXHJcbiAgICAgICAgcmVzcG9uc2U6ICdSZXNwdWVzdGEgbGVnYWwgZGV0YWxsYWRhJyxcclxuICAgICAgICBzb3VyY2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAnTGV5IDEyMyBkZSAyMDI0JyxcclxuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuaW1wcmVudGEuZ292LmNvJyxcclxuICAgICAgICAgICAgdHlwZTogJ29mZmljaWFsJyxcclxuICAgICAgICAgICAgcXVhbGl0eTogOSxcclxuICAgICAgICAgICAgYXV0aG9yaXR5OiAnbWF4aW1hJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgdmVyaWZpY2F0aW9uOiB7XHJcbiAgICAgICAgICBwYXNzZWQ6IHRydWUsXHJcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjk1LFxyXG4gICAgICAgICAgY2hlY2tzOiBbJ3NvdXJjZV92YWxpZGF0aW9uJywgJ2ZhY3RfY2hlY2tpbmcnLCAnbGVnYWxfcmVmZXJlbmNlJ11cclxuICAgICAgICB9LFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgICB1c2VySWQ6IHRlc3RVc2VySWQsXHJcbiAgICAgICAgY2hhdElkOiB0ZXN0Q2hhdElkXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGF3YWl0IG1lbW9yeU1hbmFnZXIuYWRkTWVzc2FnZSh0ZXN0Q2hhdElkLCB0ZXN0VXNlcklkLCB7XHJcbiAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXHJcbiAgICAgICAgY29udGVudDogYXVkaXREYXRhLnJlc3BvbnNlLFxyXG4gICAgICAgIHRpbWVzdGFtcDogYXVkaXREYXRhLnRpbWVzdGFtcCxcclxuICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgc291cmNlczogYXVkaXREYXRhLnNvdXJjZXMsXHJcbiAgICAgICAgICB2ZXJpZmljYXRpb246IGF1ZGl0RGF0YS52ZXJpZmljYXRpb24sXHJcbiAgICAgICAgICBxdWFsaXR5OiA5XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8gVmVyaWZpY2FyIHF1ZSBzZSByZWdpc3Ryw7MgdG9kYSBsYSBpbmZvcm1hY2nDs24gbmVjZXNhcmlhIHBhcmEgYXVkaXRvcsOtYVxyXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmZyb20oKS5pbnNlcnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgIGNoYXRfaWQ6IGF1ZGl0RGF0YS5jaGF0SWQsXHJcbiAgICAgICAgICB1c2VyX2lkOiBhdWRpdERhdGEudXNlcklkLFxyXG4gICAgICAgICAgY29udGVudDogYXVkaXREYXRhLnJlc3BvbnNlLFxyXG4gICAgICAgICAgbWV0YWRhdGE6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcclxuICAgICAgICAgICAgc291cmNlczogYXVkaXREYXRhLnNvdXJjZXMsXHJcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbjogYXVkaXREYXRhLnZlcmlmaWNhdGlvbixcclxuICAgICAgICAgICAgcXVhbGl0eTogOVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICB9KVxyXG5cclxuICAgIHRlc3QoJ2RlYmUgcGVybWl0aXIgZWxpbWluYWNpw7NuIGRlIGRhdG9zIHBhcmEgR0RQUicsIGFzeW5jICgpID0+IHtcclxuICAgICAgYXdhaXQgbWVtb3J5TWFuYWdlci5jbGVhckNoYXRNZW1vcnkodGVzdFVzZXJJZCwgdGVzdENoYXRJZClcclxuXHJcbiAgICAgIC8vIFZlcmlmaWNhciBxdWUgc2UgbGxhbWFyb24gbGFzIG9wZXJhY2lvbmVzIGRlIGVsaW1pbmFjacOzblxyXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmZyb20pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdtZXNzYWdlcycpXHJcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2NoYXRfY29udGV4dHMnKVxyXG4gICAgfSlcclxuICB9KVxyXG59KVxyXG5cclxuZGVzY3JpYmUoJ0NoYXRNZW1vcnlNYW5hZ2VyIC0gVGVzdHMgZGUgSW50ZWdyYWNpw7NuJywgKCkgPT4ge1xyXG4gIGxldCBtZW1vcnlNYW5hZ2VyOiBDaGF0TWVtb3J5TWFuYWdlclxyXG4gIGNvbnN0IHRlc3RVc2VySWQgPSAnaW50ZWdyYXRpb24tdGVzdC11c2VyJ1xyXG4gIGNvbnN0IHRlc3RDaGF0SWQgPSAnaW50ZWdyYXRpb24tdGVzdC1jaGF0J1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIG1lbW9yeU1hbmFnZXIgPSBuZXcgQ2hhdE1lbW9yeU1hbmFnZXIoKVxyXG4gIH0pXHJcblxyXG4gIHRlc3QoJ2RlYmUgbWFudGVuZXIgY29uc2lzdGVuY2lhIGRlIGRhdG9zIGVuIG9wZXJhY2lvbmVzIGNvbXBsZWphcycsIGFzeW5jICgpID0+IHtcclxuICAgIC8vIFNpbXVsYXIgZmx1am8gY29tcGxldG8gZGUgY29uc3VsdGEgbGVnYWxcclxuICAgIGNvbnN0IHVzZXJRdWVyeSA9ICfCv0N1w6FsZXMgc29uIGxvcyBwYXNvcyBwYXJhIGNvbnN0aXR1aXIgdW5hIFNBUz8nXHJcbiAgICBcclxuICAgIC8vIDEuIFJlZ2lzdHJhciBjb25zdWx0YSBkZWwgdXN1YXJpb1xyXG4gICAgYXdhaXQgbWVtb3J5TWFuYWdlci5hZGRNZXNzYWdlKHRlc3RDaGF0SWQsIHRlc3RVc2VySWQsIHtcclxuICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICBjb250ZW50OiB1c2VyUXVlcnksXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyAyLiBSZWdpc3RyYXIgYsO6c3F1ZWRhcyByZWFsaXphZGFzXHJcbiAgICBhd2FpdCBtZW1vcnlNYW5hZ2VyLmFkZFNlYXJjaEhpc3RvcnkodGVzdENoYXRJZCwgdGVzdFVzZXJJZCwge1xyXG4gICAgICBxdWVyeTogJ2NvbnN0aXR1Y2nDs24gU0FTIENvbG9tYmlhIHJlcXVpc2l0b3MnLFxyXG4gICAgICByZXN1bHRzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgdGl0bGU6ICdDw7NkaWdvIGRlIENvbWVyY2lvIC0gQXJ0w61jdWxvIDExMCcsXHJcbiAgICAgICAgICB1cmw6ICdodHRwczovL3d3dy5zdWluLWp1cmlzY29sLmdvdi5jbycsXHJcbiAgICAgICAgICB0eXBlOiAnb2ZmaWNpYWwnLFxyXG4gICAgICAgICAgcXVhbGl0eTogOVxyXG4gICAgICAgIH1cclxuICAgICAgXSxcclxuICAgICAgbW9kZTogJ2xlZ2FsX3NlYXJjaCcsXHJcbiAgICAgIHF1YWxpdHk6IDksXHJcbiAgICAgIGR1cmF0aW9uOiAyMDAwXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIDMuIENhY2hlYXIgZnVlbnRlIGVuY29udHJhZGFcclxuICAgIGF3YWl0IG1lbW9yeU1hbmFnZXIuY2FjaGVTb3VyY2UodGVzdENoYXRJZCwgdGVzdFVzZXJJZCwge1xyXG4gICAgICB1cmw6ICdodHRwczovL3d3dy5zdWluLWp1cmlzY29sLmdvdi5jbycsXHJcbiAgICAgIHRpdGxlOiAnQ8OzZGlnbyBkZSBDb21lcmNpbyAtIEFydMOtY3VsbyAxMTAnLFxyXG4gICAgICBjb250ZW50OiAnQ29udGVuaWRvIGRlbCBhcnTDrWN1bG8uLi4nLFxyXG4gICAgICB0eXBlOiAnb2ZmaWNpYWwnLFxyXG4gICAgICBxdWFsaXR5OiA5LFxyXG4gICAgICBhdXRob3JpdHk6ICdtYXhpbWEnXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIDQuIFJlZ2lzdHJhciByZXNwdWVzdGEgZGVsIGFzaXN0ZW50ZVxyXG4gICAgYXdhaXQgbWVtb3J5TWFuYWdlci5hZGRNZXNzYWdlKHRlc3RDaGF0SWQsIHRlc3RVc2VySWQsIHtcclxuICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXHJcbiAgICAgIGNvbnRlbnQ6ICdQYXJhIGNvbnN0aXR1aXIgdW5hIFNBUyBlbiBDb2xvbWJpYS4uLicsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICBzb3VyY2VzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHRpdGxlOiAnQ8OzZGlnbyBkZSBDb21lcmNpbyAtIEFydMOtY3VsbyAxMTAnLFxyXG4gICAgICAgICAgICB1cmw6ICdodHRwczovL3d3dy5zdWluLWp1cmlzY29sLmdvdi5jbycsXHJcbiAgICAgICAgICAgIHR5cGU6ICdvZmZpY2lhbCcsXHJcbiAgICAgICAgICAgIHF1YWxpdHk6IDksXHJcbiAgICAgICAgICAgIGF1dGhvcml0eTogJ21heGltYSdcclxuICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIHF1YWxpdHk6IDksXHJcbiAgICAgICAgdmVyaWZpY2F0aW9uOiB7IHBhc3NlZDogdHJ1ZSwgY29uZmlkZW5jZTogMC45NSB9LFxyXG4gICAgICAgIG1vZGU6ICdpdGVyX3Jlc2VhcmNoJ1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIDUuIFZlcmlmaWNhciBxdWUgdG9kYXMgbGFzIG9wZXJhY2lvbmVzIHNlIHJlZ2lzdHJhcm9uXHJcbiAgICBleHBlY3QobW9ja1N1cGFiYXNlQ2xpZW50LmZyb20pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcyg2KSAvLyAyIG1lbnNhamVzICsgMSBiw7pzcXVlZGEgKyAxIGNhY2hlICsgMiBjb250ZXh0b3NcclxuICB9KVxyXG59KVxyXG4iXSwidmVyc2lvbiI6M30=