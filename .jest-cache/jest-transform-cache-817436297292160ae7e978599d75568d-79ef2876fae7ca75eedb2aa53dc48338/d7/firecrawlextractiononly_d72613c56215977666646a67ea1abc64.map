{"version":3,"names":["cov_ekapzqjyw","actualCoverage","exports","extractWithFireCrawl","s","extractMultipleWithFireCrawl","axios_1","__importDefault","require","FireCrawlExtractionClient","apiKey","baseUrl","constructor","f","b","process","env","FIRECRAWL_API_KEY","console","warn","extractContent","url","success","error","log","response","default","post","formats","onlyMainContent","maxLength","waitFor","headers","timeout","data","markdown","length","content","html","title","metadata","description","message","extractMultipleUrls","urls","results","Map","batchSize","i","batch","slice","batchPromises","map","result","batchResults","Promise","all","forEach","set","resolve","setTimeout","size","isAvailable","testResult","includes","fireCrawlExtractionClient"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\tools\\firecrawl-extraction-only.ts"],"sourcesContent":["import axios from 'axios'\r\n\r\nexport interface FireCrawlExtractionResult {\r\n  success: boolean\r\n  content?: string\r\n  title?: string\r\n  description?: string\r\n  error?: string\r\n}\r\n\r\n/**\r\n * Cliente para FireCrawl v2 - Solo para extracci√≥n de contenido\r\n * NO incluye funcionalidad de b√∫squeda (search)\r\n */\r\nexport class FireCrawlExtractionClient {\r\n  private apiKey: string\r\n  private baseUrl: string = 'https://api.firecrawl.dev/v2'\r\n\r\n  constructor(apiKey?: string) {\r\n    this.apiKey = apiKey || process.env.FIRECRAWL_API_KEY || ''\r\n    \r\n    if (!this.apiKey) {\r\n      console.warn('‚ö†Ô∏è FireCrawl API Key no configurada. Define FIRECRAWL_API_KEY.')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extrae contenido de una URL usando FireCrawl v2\r\n   */\r\n  async extractContent(url: string): Promise<FireCrawlExtractionResult> {\r\n    if (!this.apiKey) {\r\n      return {\r\n        success: false,\r\n        error: 'FireCrawl API Key no configurada'\r\n      }\r\n    }\r\n\r\n    try {\r\n      console.log(`üî• FireCrawl Extraction: ${url}`)\r\n      \r\n      const response = await axios.post(\r\n        `${this.baseUrl}/scrape`,\r\n        {\r\n          url: url,\r\n          formats: ['markdown', 'html'],\r\n          onlyMainContent: true,\r\n          maxLength: 8000,\r\n          waitFor: 2000\r\n        },\r\n        {\r\n          headers: {\r\n            'Authorization': `Bearer ${this.apiKey}`,\r\n            'Content-Type': 'application/json'\r\n          },\r\n          timeout: 30000 // 30 segundos timeout\r\n        }\r\n      )\r\n\r\n      const data = response.data?.data\r\n      if (data) {\r\n        console.log(`‚úÖ FireCrawl Extraction exitosa: ${data.markdown?.length || 0} caracteres`)\r\n        \r\n        return {\r\n          success: true,\r\n          content: data.markdown || data.html || '',\r\n          title: data.metadata?.title || '',\r\n          description: data.metadata?.description || ''\r\n        }\r\n      }\r\n\r\n      return {\r\n        success: false,\r\n        error: 'No se pudo extraer contenido'\r\n      }\r\n\r\n    } catch (error: any) {\r\n      console.error('‚ùå Error en FireCrawl Extraction:', error.message)\r\n      \r\n      return {\r\n        success: false,\r\n        error: error.message || 'Error desconocido en FireCrawl Extraction'\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extrae contenido de m√∫ltiples URLs en paralelo\r\n   */\r\n  async extractMultipleUrls(urls: string[]): Promise<Map<string, FireCrawlExtractionResult>> {\r\n    console.log(`üî• FireCrawl Extraction m√∫ltiple: ${urls.length} URLs`)\r\n    \r\n    const results = new Map<string, FireCrawlExtractionResult>()\r\n    \r\n    // Procesar en lotes de 3 para evitar rate limiting\r\n    const batchSize = 3\r\n    for (let i = 0; i < urls.length; i += batchSize) {\r\n      const batch = urls.slice(i, i + batchSize)\r\n      \r\n      const batchPromises = batch.map(async (url) => {\r\n        const result = await this.extractContent(url)\r\n        return { url, result }\r\n      })\r\n      \r\n      const batchResults = await Promise.all(batchPromises)\r\n      \r\n      batchResults.forEach(({ url, result }) => {\r\n        results.set(url, result)\r\n      })\r\n      \r\n      // Pausa entre lotes\r\n      if (i + batchSize < urls.length) {\r\n        await new Promise(resolve => setTimeout(resolve, 1000))\r\n      }\r\n    }\r\n    \r\n    console.log(`‚úÖ FireCrawl Extraction m√∫ltiple completada: ${results.size} URLs procesadas`)\r\n    return results\r\n  }\r\n\r\n  /**\r\n   * Verifica si FireCrawl est√° disponible\r\n   */\r\n  async isAvailable(): Promise<boolean> {\r\n    if (!this.apiKey) return false\r\n    \r\n    try {\r\n      // Hacer una prueba simple con una URL conocida\r\n      const testResult = await this.extractContent('https://example.com')\r\n      return testResult.success || testResult.error?.includes('timeout')\r\n    } catch {\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Instancia singleton del cliente FireCrawl\r\n */\r\nexport const fireCrawlExtractionClient = new FireCrawlExtractionClient()\r\n\r\n/**\r\n * Funci√≥n de conveniencia para extracci√≥n r√°pida\r\n */\r\nexport async function extractWithFireCrawl(url: string): Promise<FireCrawlExtractionResult> {\r\n  return await fireCrawlExtractionClient.extractContent(url)\r\n}\r\n\r\n/**\r\n * Funci√≥n de conveniencia para extracci√≥n m√∫ltiple\r\n */\r\nexport async function extractMultipleWithFireCrawl(urls: string[]): Promise<Map<string, FireCrawlExtractionResult>> {\r\n  return await fireCrawlExtractionClient.extractMultipleUrls(urls)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}