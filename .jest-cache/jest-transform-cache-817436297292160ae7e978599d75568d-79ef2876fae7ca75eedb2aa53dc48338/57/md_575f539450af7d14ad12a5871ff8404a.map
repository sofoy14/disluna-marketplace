{"version":3,"names":["cov_1tq9pndpei","actualCoverage","s","gpt_tokenizer_1","require","text_splitter_1","_1","processMarkdown","markdown","f","fileBuffer","Buffer","from","arrayBuffer","textDecoder","TextDecoder","textContent","decode","splitter","RecursiveCharacterTextSplitter","fromLanguage","chunkSize","CHUNK_SIZE","chunkOverlap","CHUNK_OVERLAP","splitDocs","createDocuments","chunks","i","length","doc","push","content","pageContent","tokens","encode","exports"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\retrieval\\processing\\md.ts"],"sourcesContent":["import { FileItemChunk } from \"@/types\"\r\nimport { encode } from \"gpt-tokenizer\"\r\nimport { RecursiveCharacterTextSplitter } from \"langchain/text_splitter\"\r\nimport { CHUNK_OVERLAP, CHUNK_SIZE } from \".\"\r\n\r\nexport const processMarkdown = async (\r\n  markdown: Blob\r\n): Promise<FileItemChunk[]> => {\r\n  const fileBuffer = Buffer.from(await markdown.arrayBuffer())\r\n  const textDecoder = new TextDecoder(\"utf-8\")\r\n  const textContent = textDecoder.decode(fileBuffer)\r\n\r\n  const splitter = RecursiveCharacterTextSplitter.fromLanguage(\"markdown\", {\r\n    chunkSize: CHUNK_SIZE,\r\n    chunkOverlap: CHUNK_OVERLAP\r\n  })\r\n\r\n  const splitDocs = await splitter.createDocuments([textContent])\r\n\r\n  let chunks: FileItemChunk[] = []\r\n\r\n  for (let i = 0; i < splitDocs.length; i++) {\r\n    const doc = splitDocs[i]\r\n\r\n    chunks.push({\r\n      content: doc.pageContent,\r\n      tokens: encode(doc.pageContent).length\r\n    })\r\n  }\r\n\r\n  return chunks\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAmBM;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;;AAlBN,MAAAC,eAAA;AAAA;AAAA,CAAAH,cAAA,GAAAE,CAAA,OAAAE,OAAA;AACA,MAAAC,eAAA;AAAA;AAAA,CAAAL,cAAA,GAAAE,CAAA,OAAAE,OAAA;AACA,MAAAE,EAAA;AAAA;AAAA,CAAAN,cAAA,GAAAE,CAAA,OAAAE,OAAA;AAA6C;AAAAJ,cAAA,GAAAE,CAAA;AAEtC,MAAMK,eAAe,GAAG,MAC7BC,QAAc,IACc;EAAA;EAAAR,cAAA,GAAAS,CAAA;EAC5B,MAAMC,UAAU;EAAA;EAAA,CAAAV,cAAA,GAAAE,CAAA,OAAGS,MAAM,CAACC,IAAI,CAAC,MAAMJ,QAAQ,CAACK,WAAW,EAAE,CAAC;EAC5D,MAAMC,WAAW;EAAA;EAAA,CAAAd,cAAA,GAAAE,CAAA,OAAG,IAAIa,WAAW,CAAC,OAAO,CAAC;EAC5C,MAAMC,WAAW;EAAA;EAAA,CAAAhB,cAAA,GAAAE,CAAA,OAAGY,WAAW,CAACG,MAAM,CAACP,UAAU,CAAC;EAElD,MAAMQ,QAAQ;EAAA;EAAA,CAAAlB,cAAA,GAAAE,CAAA,OAAGG,eAAA,CAAAc,8BAA8B,CAACC,YAAY,CAAC,UAAU,EAAE;IACvEC,SAAS,EAAEf,EAAA,CAAAgB,UAAU;IACrBC,YAAY,EAAEjB,EAAA,CAAAkB;GACf,CAAC;EAEF,MAAMC,SAAS;EAAA;EAAA,CAAAzB,cAAA,GAAAE,CAAA,QAAG,MAAMgB,QAAQ,CAACQ,eAAe,CAAC,CAACV,WAAW,CAAC,CAAC;EAE/D,IAAIW,MAAM;EAAA;EAAA,CAAA3B,cAAA,GAAAE,CAAA,QAAoB,EAAE;EAAA;EAAAF,cAAA,GAAAE,CAAA;EAEhC,KAAK,IAAI0B,CAAC;EAAA;EAAA,CAAA5B,cAAA,GAAAE,CAAA,QAAG,CAAC,GAAE0B,CAAC,GAAGH,SAAS,CAACI,MAAM,EAAED,CAAC,EAAE,EAAE;IACzC,MAAME,GAAG;IAAA;IAAA,CAAA9B,cAAA,GAAAE,CAAA,QAAGuB,SAAS,CAACG,CAAC,CAAC;IAAA;IAAA5B,cAAA,GAAAE,CAAA;IAExByB,MAAM,CAACI,IAAI,CAAC;MACVC,OAAO,EAAEF,GAAG,CAACG,WAAW;MACxBC,MAAM,EAAE,IAAA/B,eAAA,CAAAgC,MAAM,EAACL,GAAG,CAACG,WAAW,CAAC,CAACJ;KACjC,CAAC;EACJ;EAAC;EAAA7B,cAAA,GAAAE,CAAA;EAED,OAAOyB,MAAM;AACf,CAAC;AAAA;AAAA3B,cAAA,GAAAE,CAAA;AA1BYkC,OAAA,CAAA7B,eAAe,GAAAA,eAAA","ignoreList":[]}