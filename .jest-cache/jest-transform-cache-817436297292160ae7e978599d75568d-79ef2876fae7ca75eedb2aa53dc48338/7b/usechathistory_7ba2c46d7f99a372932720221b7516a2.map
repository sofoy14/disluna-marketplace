{"version":3,"names":["cov_mugcoajk","actualCoverage","s","context_1","require","react_1","useChatHistoryHandler","f","setUserInput","chatMessages","isGenerating","useContext","ChatbotUIContext","userRoleString","messageHistoryIndex","setMessageHistoryIndex","useState","length","useEffect","b","setNewMessageContentToPreviousUserMessage","tempIndex","message","role","previousUserMessage","content","setNewMessageContentToNextUserMessage","nextUserMessage","exports"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\components\\chat\\chat-hooks\\use-chat-history.tsx"],"sourcesContent":["import { ChatbotUIContext } from \"@/context/context\"\r\nimport { useContext, useEffect, useState } from \"react\"\r\n\r\n/**\r\n * Custom hook for handling chat history in the chat component.\r\n * It provides functions to set the new message content to the previous or next user message in the chat history.\r\n *\r\n * @returns An object containing the following functions:\r\n *   - setNewMessageContentToPreviousUserMessage: Sets the new message content to the previous user message.\r\n *   - setNewMessageContentToNextUserMessage: Sets the new message content to the next user message in the chat history.\r\n */\r\nexport const useChatHistoryHandler = () => {\r\n  const { setUserInput, chatMessages, isGenerating } =\r\n    useContext(ChatbotUIContext)\r\n  const userRoleString = \"user\"\r\n\r\n  const [messageHistoryIndex, setMessageHistoryIndex] = useState<number>(\r\n    chatMessages.length\r\n  )\r\n\r\n  useEffect(() => {\r\n    // If messages get deleted the history index pointed could be out of bounds\r\n    if (!isGenerating && messageHistoryIndex > chatMessages.length)\r\n      setMessageHistoryIndex(chatMessages.length)\r\n  }, [chatMessages, isGenerating, messageHistoryIndex])\r\n\r\n  /**\r\n   * Sets the new message content to the previous user message.\r\n   */\r\n  const setNewMessageContentToPreviousUserMessage = () => {\r\n    let tempIndex = messageHistoryIndex\r\n    while (\r\n      tempIndex > 0 &&\r\n      chatMessages[tempIndex - 1].message.role !== userRoleString\r\n    ) {\r\n      tempIndex--\r\n    }\r\n\r\n    const previousUserMessage =\r\n      chatMessages.length > 0 && tempIndex > 0\r\n        ? chatMessages[tempIndex - 1]\r\n        : null\r\n    if (previousUserMessage) {\r\n      setUserInput(previousUserMessage.message.content)\r\n      setMessageHistoryIndex(tempIndex - 1)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets the new message content to the next user message in the chat history.\r\n   * If there is a next user message, it updates the user input and message history index accordingly.\r\n   * If there is no next user message, it resets the user input and sets the message history index to the end of the chat history.\r\n   */\r\n  const setNewMessageContentToNextUserMessage = () => {\r\n    let tempIndex = messageHistoryIndex\r\n    while (\r\n      tempIndex < chatMessages.length - 1 &&\r\n      chatMessages[tempIndex + 1].message.role !== userRoleString\r\n    ) {\r\n      tempIndex++\r\n    }\r\n\r\n    const nextUserMessage =\r\n      chatMessages.length > 0 && tempIndex < chatMessages.length - 1\r\n        ? chatMessages[tempIndex + 1]\r\n        : null\r\n    setUserInput(nextUserMessage?.message.content || \"\")\r\n    setMessageHistoryIndex(\r\n      nextUserMessage ? tempIndex + 1 : chatMessages.length\r\n    )\r\n  }\r\n\r\n  return {\r\n    setNewMessageContentToPreviousUserMessage,\r\n    setNewMessageContentToNextUserMessage\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}