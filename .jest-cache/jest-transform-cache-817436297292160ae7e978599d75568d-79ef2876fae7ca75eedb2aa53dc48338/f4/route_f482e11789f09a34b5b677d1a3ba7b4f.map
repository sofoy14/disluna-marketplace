{"version":3,"names":["cov_13awy9hhbf","actualCoverage","exports","POST","ai_1","s","require","openai_1","__importDefault","conditional_web_search_1","request","f","json","chatSettings","messages","openrouterApiKey","b","process","env","OPENROUTER_API_KEY","Response","JSON","stringify","message","status","headers","openai","default","apiKey","baseURL","timeout","maxRetries","lastUserMessage","filter","m","role","pop","userQuery","content","console","log","repeat","substring","model","searchResult","executeConditionalWebSearch","logDetection","shouldSearch","detectionResult","confidence","toFixed","reason","systemMessage","generateSystemMessage","enhancedMessages","length","unshift","searchResults","results","modelToUse","response","chat","completions","create","temperature","max_tokens","undefined","stream","OpenAIStream","StreamingTextResponse","openaiError","error","fallbackResponse","fallbackError","errorMessage","errorCode","code","timestamp","Date","toISOString","details","hasOpenRouterKey","openRouterKeyPreview"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\app\\api\\chat\\independent\\route.ts"],"sourcesContent":["import { ChatSettings } from \"@/types\"\r\nimport { OpenAIStream, StreamingTextResponse } from \"ai\"\r\nimport OpenAI from \"openai\"\r\nimport { ChatCompletionCreateParamsBase } from \"openai/resources/chat/completions.mjs\"\r\nimport { executeConditionalWebSearch, generateSystemMessage } from \"@/lib/tools/conditional-web-search\"\r\n\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const json = await request.json()\r\n    const { chatSettings, messages } = json as {\r\n      chatSettings: ChatSettings\r\n      messages: any[]\r\n    }\r\n\r\n    // Usar API key de OpenRouter desde variables de entorno\r\n    const openrouterApiKey = process.env.OPENROUTER_API_KEY || \"\"\r\n\r\n    if (!openrouterApiKey) {\r\n      return new Response(JSON.stringify({ \r\n        message: \"OpenRouter API Key no configurada. Por favor configura OPENROUTER_API_KEY en las variables de entorno.\" \r\n      }), { \r\n        status: 500,\r\n        headers: { \"Content-Type\": \"application/json\" }\r\n      })\r\n    }\r\n\r\n    // Crear cliente OpenAI con configuraci√≥n robusta\r\n    const openai = new OpenAI({\r\n      apiKey: openrouterApiKey,\r\n      baseURL: \"https://openrouter.ai/api/v1\",\r\n      timeout: 60000, // 60 segundos timeout\r\n      maxRetries: 3\r\n    })\r\n\r\n    // üß† B√öSQUEDA WEB INTELIGENTE - SOLO CUANDO ES NECESARIO\r\n    const lastUserMessage = messages.filter(m => m.role === 'user').pop()\r\n    const userQuery = lastUserMessage?.content || ''\r\n    \r\n    console.log(`\\n${\"üß†\".repeat(60)}`)\r\n    console.log(`üîç CHAT INDEPENDIENTE - B√öSQUEDA WEB INTELIGENTE`)\r\n    console.log(`   Query: \"${userQuery.substring(0, 50)}...\"`)\r\n    console.log(`   Usuario: usuario-anonimo`)\r\n    console.log(`   Modelo: ${chatSettings.model}`)\r\n    console.log(`${\"üß†\".repeat(60)}\\n`)\r\n    \r\n    // Ejecutar b√∫squeda condicional inteligente\r\n    const searchResult = await executeConditionalWebSearch(userQuery, {\r\n      logDetection: true\r\n    })\r\n    \r\n    console.log(`\\n${\"üß†\".repeat(60)}`)\r\n    console.log(`‚úÖ AN√ÅLISIS INTELIGENTE COMPLETADO`)\r\n    console.log(`   üîç B√∫squeda requerida: ${searchResult.shouldSearch ? 'S√ç' : 'NO'}`)\r\n    console.log(`   üéØ Confianza: ${(searchResult.detectionResult.confidence * 100).toFixed(1)}%`)\r\n    console.log(`   üìã Raz√≥n: ${searchResult.detectionResult.reason}`)\r\n    console.log(`${\"üß†\".repeat(60)}\\n`)\r\n\r\n    // Generar mensaje de sistema apropiado\r\n    const systemMessage = {\r\n      role: \"system\",\r\n      content: generateSystemMessage(userQuery, searchResult)\r\n    }\r\n\r\n    // Preparar mensajes\r\n    const enhancedMessages = [...messages]\r\n    \r\n    // Insertar el mensaje de sistema al inicio\r\n    if (enhancedMessages.length === 0 || enhancedMessages[0].role !== \"system\") {\r\n      enhancedMessages.unshift(systemMessage)\r\n    } else {\r\n      // Si ya hay un mensaje de sistema, agregar las instrucciones\r\n      enhancedMessages[0].content = `${enhancedMessages[0].content}\\n\\n${systemMessage.content}`\r\n    }\r\n\r\n    console.log(`‚öñÔ∏è Chat Independiente: Configurado con b√∫squeda inteligente ${searchResult.shouldSearch ? `(${searchResult.searchResults?.results?.length || 0} resultados)` : '(sin b√∫squeda requerida)'}`)\r\n\r\n    // Usar un modelo m√°s estable por defecto\r\n    const modelToUse = chatSettings.model || \"openai/gpt-3.5-turbo\"\r\n    \r\n    console.log(`ü§ñ Usando modelo: ${modelToUse}`)\r\n\r\n    // Crear respuesta con OpenAI con manejo robusto de errores\r\n    try {\r\n      const response = await openai.chat.completions.create({\r\n        model: modelToUse as ChatCompletionCreateParamsBase[\"model\"],\r\n        messages: enhancedMessages as ChatCompletionCreateParamsBase[\"messages\"],\r\n        temperature: chatSettings.temperature || 0.7,\r\n        max_tokens: undefined,\r\n        stream: true\r\n      })\r\n\r\n      const stream = OpenAIStream(response)\r\n      return new StreamingTextResponse(stream)\r\n    } catch (openaiError: any) {\r\n      console.error('Error espec√≠fico de OpenAI:', openaiError)\r\n      \r\n      // Si falla con el modelo especificado, intentar con un modelo por defecto\r\n      if (modelToUse !== \"openai/gpt-3.5-turbo\") {\r\n        console.log(`üîÑ Reintentando con modelo por defecto: openai/gpt-3.5-turbo`)\r\n        \r\n        try {\r\n          const fallbackResponse = await openai.chat.completions.create({\r\n            model: \"openai/gpt-3.5-turbo\" as ChatCompletionCreateParamsBase[\"model\"],\r\n            messages: enhancedMessages as ChatCompletionCreateParamsBase[\"messages\"],\r\n            temperature: 0.7,\r\n            max_tokens: undefined,\r\n            stream: true\r\n          })\r\n\r\n          const stream = OpenAIStream(fallbackResponse)\r\n          return new StreamingTextResponse(stream)\r\n        } catch (fallbackError: any) {\r\n          console.error('Error en modelo de respaldo:', fallbackError)\r\n          throw fallbackError\r\n        }\r\n      } else {\r\n        throw openaiError\r\n      }\r\n    }\r\n  } catch (error: any) {\r\n    console.error('Error en chat independiente:', error)\r\n    \r\n    // Respuesta de error m√°s informativa\r\n    const errorMessage = error.message || \"An unexpected error occurred\"\r\n    const errorCode = error.status || 500\r\n\r\n    return new Response(JSON.stringify({ \r\n      message: `Error en chat independiente: ${errorMessage}`,\r\n      error: errorMessage,\r\n      code: errorCode,\r\n      timestamp: new Date().toISOString(),\r\n      details: {\r\n        hasOpenRouterKey: !!process.env.OPENROUTER_API_KEY,\r\n        openRouterKeyPreview: process.env.OPENROUTER_API_KEY ? \r\n          `${process.env.OPENROUTER_API_KEY.substring(0, 10)}...` : 'No configurada'\r\n      }\r\n    }), {\r\n      status: errorCode,\r\n      headers: { \"Content-Type\": \"application/json\" }\r\n    })\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}