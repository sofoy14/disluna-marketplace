{"version":3,"names":["cov_840pni5cz","actualCoverage","s","exports","POST","server_1","require","legal_search_specialized_1","request","f","body","json","query","numResults","b","enrich","NextResponse","error","status","console","log","searchResult","searchLegalSpecialized","success","results","sources","timestamp","searchStrategy","note","finalResults","length","enrichLegalResults","map","r","url","enriched","summary","totalResults","officialSources","filter","type","academicSources","newsSources","generalSources","averageRelevance","reduce","sum","relevance","details","Error","message"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\app\\api\\tools\\legal-search-specialized\\route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { searchLegalSpecialized, enrichLegalResults } from '@/lib/tools/legal-search-specialized'\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json()\r\n    const { query, numResults = 5, enrich = false } = body\r\n\r\n    if (!query || typeof query !== 'string') {\r\n      return NextResponse.json(\r\n        { error: 'Query es requerida y debe ser un string' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    console.log(`‚öñÔ∏è [Legal Search API] B√∫squeda especializada: \"${query}\"`)\r\n\r\n    // Realizar b√∫squeda legal especializada\r\n    const searchResult = await searchLegalSpecialized(query, numResults)\r\n\r\n    if (!searchResult.success) {\r\n      return NextResponse.json({\r\n        success: false,\r\n        query,\r\n        results: [],\r\n        sources: [],\r\n        timestamp: searchResult.timestamp,\r\n        searchStrategy: searchResult.searchStrategy,\r\n        error: searchResult.error,\r\n        note: searchResult.note\r\n      })\r\n    }\r\n\r\n    let finalResults = searchResult.results\r\n\r\n    // Enriquecer resultados si se solicita\r\n    if (enrich && searchResult.results.length > 0) {\r\n      console.log(`üìö Enriqueciendo ${searchResult.results.length} resultados legales...`)\r\n      finalResults = await enrichLegalResults(searchResult.results, 3)\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      query,\r\n      results: finalResults,\r\n      sources: finalResults.map(r => r.url),\r\n      timestamp: searchResult.timestamp,\r\n      searchStrategy: searchResult.searchStrategy,\r\n      enriched: enrich,\r\n      summary: {\r\n        totalResults: finalResults.length,\r\n        officialSources: finalResults.filter(r => r.type === 'official').length,\r\n        academicSources: finalResults.filter(r => r.type === 'academic').length,\r\n        newsSources: finalResults.filter(r => r.type === 'news').length,\r\n        generalSources: finalResults.filter(r => r.type === 'general').length,\r\n        averageRelevance: finalResults.reduce((sum, r) => sum + r.relevance, 0) / finalResults.length\r\n      }\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Error en Legal Search API:', error)\r\n    return NextResponse.json(\r\n      { \r\n        success: false,\r\n        error: 'Error interno del servidor',\r\n        details: error instanceof Error ? error.message : 'Unknown error'\r\n      },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}