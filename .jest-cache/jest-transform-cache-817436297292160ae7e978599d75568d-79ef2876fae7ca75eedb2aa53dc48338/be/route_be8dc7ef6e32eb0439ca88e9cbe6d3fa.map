{"version":3,"names":["cov_khrhwh6aj","actualCoverage","s","exports","POST","GET","server_1","require","web_search_1","runtime","request","f","query","json","b","NextResponse","error","status","console","log","searchResponse","searchWebEnriched","success","formattedContext","formatSearchResultsForContext","results","sources","timestamp","Error","message","searchParams","URL","url","get","Request","method","headers","body","JSON","stringify"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\app\\api\\tools\\web-search\\route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { searchWebEnriched, formatSearchResultsForContext } from '@/lib/tools/web-search'\r\n\r\nexport const runtime = 'edge'\r\n\r\n/**\r\n * API endpoint para b√∫squeda web con herramientas de c√≥digo abierto\r\n * POST /api/tools/web-search\r\n * Body: { query: string }\r\n */\r\nexport async function POST(request: Request) {\r\n  try {\r\n    const { query } = await request.json()\r\n\r\n    if (!query || typeof query !== 'string') {\r\n      return NextResponse.json(\r\n        { error: 'Query parameter is required' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    console.log(`üîç [API] B√∫squeda web solicitada: \"${query}\"`)\r\n\r\n    // Realizar b√∫squeda enriquecida\r\n    const searchResponse = await searchWebEnriched(query)\r\n\r\n    if (!searchResponse.success) {\r\n      return NextResponse.json(\r\n        { \r\n          error: searchResponse.error || 'Search failed',\r\n          query\r\n        },\r\n        { status: 500 }\r\n      )\r\n    }\r\n\r\n    // Formatear para contexto\r\n    const formattedContext = formatSearchResultsForContext(searchResponse)\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      query,\r\n      results: searchResponse.results,\r\n      sources: searchResponse.sources,\r\n      formattedContext,\r\n      timestamp: searchResponse.timestamp\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå [API] Error en web-search:', error)\r\n    return NextResponse.json(\r\n      { \r\n        error: error instanceof Error ? error.message : 'Internal server error'\r\n      },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\n/**\r\n * GET endpoint para testing\r\n */\r\nexport async function GET(request: Request) {\r\n  const { searchParams } = new URL(request.url)\r\n  const query = searchParams.get('q')\r\n\r\n  if (!query) {\r\n    return NextResponse.json(\r\n      { error: 'Query parameter \"q\" is required' },\r\n      { status: 400 }\r\n    )\r\n  }\r\n\r\n  return POST(new Request(request.url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify({ query })\r\n  }))\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAYI;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAAAA,aAAA,GAAAE,CAAA;;;;;;;;;AAFJC,OAAA,CAAAC,IAAA,GAAAA,IAAA;AA+CC;AAAAJ,aAAA,GAAAE,CAAA;AAKDC,OAAA,CAAAE,GAAA,GAAAA,GAAA;AA9DA,MAAAC,QAAA;AAAA;AAAA,CAAAN,aAAA,GAAAE,CAAA,OAAAK,OAAA;AACA,MAAAC,YAAA;AAAA;AAAA,CAAAR,aAAA,GAAAE,CAAA,OAAAK,OAAA;AAAyF;AAAAP,aAAA,GAAAE,CAAA;AAE5EC,OAAA,CAAAM,OAAO,GAAG,MAAM;AAE7B;;;;;AAKO,eAAeL,IAAIA,CAACM,OAAgB;EAAA;EAAAV,aAAA,GAAAW,CAAA;EAAAX,aAAA,GAAAE,CAAA;EACzC,IAAI;IACF,MAAM;MAAEU;IAAK,CAAE;IAAA;IAAA,CAAAZ,aAAA,GAAAE,CAAA,OAAG,MAAMQ,OAAO,CAACG,IAAI,EAAE;IAAA;IAAAb,aAAA,GAAAE,CAAA;IAEtC;IAAI;IAAA,CAAAF,aAAA,GAAAc,CAAA,WAACF,KAAK;IAAA;IAAA,CAAAZ,aAAA,GAAAc,CAAA,UAAI,OAAOF,KAAK,KAAK,QAAQ,GAAE;MAAA;MAAAZ,aAAA,GAAAc,CAAA;MAAAd,aAAA,GAAAE,CAAA;MACvC,OAAOI,QAAA,CAAAS,YAAY,CAACF,IAAI,CACtB;QAAEG,KAAK,EAAE;MAA6B,CAAE,EACxC;QAAEC,MAAM,EAAE;MAAG,CAAE,CAChB;IACH,CAAC;IAAA;IAAA;MAAAjB,aAAA,GAAAc,CAAA;IAAA;IAAAd,aAAA,GAAAE,CAAA;IAEDgB,OAAO,CAACC,GAAG,CAAC,sCAAsCP,KAAK,GAAG,CAAC;IAE3D;IACA,MAAMQ,cAAc;IAAA;IAAA,CAAApB,aAAA,GAAAE,CAAA,QAAG,MAAM,IAAAM,YAAA,CAAAa,iBAAiB,EAACT,KAAK,CAAC;IAAA;IAAAZ,aAAA,GAAAE,CAAA;IAErD,IAAI,CAACkB,cAAc,CAACE,OAAO,EAAE;MAAA;MAAAtB,aAAA,GAAAc,CAAA;MAAAd,aAAA,GAAAE,CAAA;MAC3B,OAAOI,QAAA,CAAAS,YAAY,CAACF,IAAI,CACtB;QACEG,KAAK;QAAE;QAAA,CAAAhB,aAAA,GAAAc,CAAA,UAAAM,cAAc,CAACJ,KAAK;QAAA;QAAA,CAAAhB,aAAA,GAAAc,CAAA,UAAI,eAAe;QAC9CF;OACD,EACD;QAAEK,MAAM,EAAE;MAAG,CAAE,CAChB;IACH,CAAC;IAAA;IAAA;MAAAjB,aAAA,GAAAc,CAAA;IAAA;IAED;IACA,MAAMS,gBAAgB;IAAA;IAAA,CAAAvB,aAAA,GAAAE,CAAA,QAAG,IAAAM,YAAA,CAAAgB,6BAA6B,EAACJ,cAAc,CAAC;IAAA;IAAApB,aAAA,GAAAE,CAAA;IAEtE,OAAOI,QAAA,CAAAS,YAAY,CAACF,IAAI,CAAC;MACvBS,OAAO,EAAE,IAAI;MACbV,KAAK;MACLa,OAAO,EAAEL,cAAc,CAACK,OAAO;MAC/BC,OAAO,EAAEN,cAAc,CAACM,OAAO;MAC/BH,gBAAgB;MAChBI,SAAS,EAAEP,cAAc,CAACO;KAC3B,CAAC;EAEJ,CAAC,CAAC,OAAOX,KAAK,EAAE;IAAA;IAAAhB,aAAA,GAAAE,CAAA;IACdgB,OAAO,CAACF,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IAAA;IAAAhB,aAAA,GAAAE,CAAA;IACpD,OAAOI,QAAA,CAAAS,YAAY,CAACF,IAAI,CACtB;MACEG,KAAK,EAAEA,KAAK,YAAYY,KAAK;MAAA;MAAA,CAAA5B,aAAA,GAAAc,CAAA,UAAGE,KAAK,CAACa,OAAO;MAAA;MAAA,CAAA7B,aAAA,GAAAc,CAAA,UAAG,uBAAuB;KACxE,EACD;MAAEG,MAAM,EAAE;IAAG,CAAE,CAChB;EACH;AACF;AAEA;;;AAGO,eAAeZ,GAAGA,CAACK,OAAgB;EAAA;EAAAV,aAAA,GAAAW,CAAA;EACxC,MAAM;IAAEmB;EAAY,CAAE;EAAA;EAAA,CAAA9B,aAAA,GAAAE,CAAA,QAAG,IAAI6B,GAAG,CAACrB,OAAO,CAACsB,GAAG,CAAC;EAC7C,MAAMpB,KAAK;EAAA;EAAA,CAAAZ,aAAA,GAAAE,CAAA,QAAG4B,YAAY,CAACG,GAAG,CAAC,GAAG,CAAC;EAAA;EAAAjC,aAAA,GAAAE,CAAA;EAEnC,IAAI,CAACU,KAAK,EAAE;IAAA;IAAAZ,aAAA,GAAAc,CAAA;IAAAd,aAAA,GAAAE,CAAA;IACV,OAAOI,QAAA,CAAAS,YAAY,CAACF,IAAI,CACtB;MAAEG,KAAK,EAAE;IAAiC,CAAE,EAC5C;MAAEC,MAAM,EAAE;IAAG,CAAE,CAChB;EACH,CAAC;EAAA;EAAA;IAAAjB,aAAA,GAAAc,CAAA;EAAA;EAAAd,aAAA,GAAAE,CAAA;EAED,OAAOE,IAAI,CAAC,IAAI8B,OAAO,CAACxB,OAAO,CAACsB,GAAG,EAAE;IACnCG,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MAAE,cAAc,EAAE;IAAkB,CAAE;IAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAE3B;IAAK,CAAE;GAC/B,CAAC,CAAC;AACL","ignoreList":[]}