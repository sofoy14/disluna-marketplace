{"version":3,"names":["cov_r13hc2m1l","actualCoverage","s","exports","consumeReadableStream","stream","callback","signal","f","reader","getReader","decoder","TextDecoder","addEventListener","cancel","once","done","value","read","b","decode","error","aborted","console","releaseLock"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\consume-stream.ts"],"sourcesContent":["export async function consumeReadableStream(\r\n  stream: ReadableStream<Uint8Array>,\r\n  callback: (chunk: string) => void,\r\n  signal: AbortSignal\r\n): Promise<void> {\r\n  const reader = stream.getReader()\r\n  const decoder = new TextDecoder()\r\n\r\n  signal.addEventListener(\"abort\", () => reader.cancel(), { once: true })\r\n\r\n  try {\r\n    while (true) {\r\n      const { done, value } = await reader.read()\r\n\r\n      if (done) {\r\n        break\r\n      }\r\n\r\n      if (value) {\r\n        callback(decoder.decode(value, { stream: true }))\r\n      }\r\n    }\r\n  } catch (error) {\r\n    if (signal.aborted) {\r\n      console.error(\"Stream reading was aborted:\", error)\r\n    } else {\r\n      console.error(\"Error consuming stream:\", error)\r\n    }\r\n  } finally {\r\n    reader.releaseLock()\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAoBM;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAAAA,aAAA,GAAAE,CAAA;;;;;;AApBNC,OAAA,CAAAC,qBAAA,GAAAA,qBAAA;AAAO,eAAeA,qBAAqBA,CACzCC,MAAkC,EAClCC,QAAiC,EACjCC,MAAmB;EAAA;EAAAP,aAAA,GAAAQ,CAAA;EAEnB,MAAMC,MAAM;EAAA;EAAA,CAAAT,aAAA,GAAAE,CAAA,OAAGG,MAAM,CAACK,SAAS,EAAE;EACjC,MAAMC,OAAO;EAAA;EAAA,CAAAX,aAAA,GAAAE,CAAA,OAAG,IAAIU,WAAW,EAAE;EAAA;EAAAZ,aAAA,GAAAE,CAAA;EAEjCK,MAAM,CAACM,gBAAgB,CAAC,OAAO,EAAE,MAAM;IAAA;IAAAb,aAAA,GAAAQ,CAAA;IAAAR,aAAA,GAAAE,CAAA;IAAA,OAAAO,MAAM,CAACK,MAAM,EAAE;EAAF,CAAE,EAAE;IAAEC,IAAI,EAAE;EAAI,CAAE,CAAC;EAAA;EAAAf,aAAA,GAAAE,CAAA;EAEvE,IAAI;IAAA;IAAAF,aAAA,GAAAE,CAAA;IACF,OAAO,IAAI,EAAE;MACX,MAAM;QAAEc,IAAI;QAAEC;MAAK,CAAE;MAAA;MAAA,CAAAjB,aAAA,GAAAE,CAAA,OAAG,MAAMO,MAAM,CAACS,IAAI,EAAE;MAAA;MAAAlB,aAAA,GAAAE,CAAA;MAE3C,IAAIc,IAAI,EAAE;QAAA;QAAAhB,aAAA,GAAAmB,CAAA;QAAAnB,aAAA,GAAAE,CAAA;QACR;MACF,CAAC;MAAA;MAAA;QAAAF,aAAA,GAAAmB,CAAA;MAAA;MAAAnB,aAAA,GAAAE,CAAA;MAED,IAAIe,KAAK,EAAE;QAAA;QAAAjB,aAAA,GAAAmB,CAAA;QAAAnB,aAAA,GAAAE,CAAA;QACTI,QAAQ,CAACK,OAAO,CAACS,MAAM,CAACH,KAAK,EAAE;UAAEZ,MAAM,EAAE;QAAI,CAAE,CAAC,CAAC;MACnD,CAAC;MAAA;MAAA;QAAAL,aAAA,GAAAmB,CAAA;MAAA;IACH;EACF,CAAC,CAAC,OAAOE,KAAK,EAAE;IAAA;IAAArB,aAAA,GAAAE,CAAA;IACd,IAAIK,MAAM,CAACe,OAAO,EAAE;MAAA;MAAAtB,aAAA,GAAAmB,CAAA;MAAAnB,aAAA,GAAAE,CAAA;MAClBqB,OAAO,CAACF,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;IACrD,CAAC,MAAM;MAAA;MAAArB,aAAA,GAAAmB,CAAA;MAAAnB,aAAA,GAAAE,CAAA;MACLqB,OAAO,CAACF,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IACjD;EACF,CAAC,SAAS;IAAA;IAAArB,aAAA,GAAAE,CAAA;IACRO,MAAM,CAACe,WAAW,EAAE;EACtB;AACF","ignoreList":[]}