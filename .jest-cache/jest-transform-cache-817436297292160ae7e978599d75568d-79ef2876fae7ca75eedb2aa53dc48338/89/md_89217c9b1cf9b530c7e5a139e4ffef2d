39327da0f600a7e7d9a3cc60f0ac9199
"use strict";

/* istanbul ignore next */
function cov_1tq9pndpei() {
  var path = "C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\retrieval\\processing\\md.ts";
  var hash = "1273665e7e42df594880c97cd5bed17eb9cb7379";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\retrieval\\processing\\md.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 2,
          column: 62
        }
      },
      "1": {
        start: {
          line: 3,
          column: 0
        },
        end: {
          line: 3,
          column: 33
        }
      },
      "2": {
        start: {
          line: 4,
          column: 24
        },
        end: {
          line: 4,
          column: 48
        }
      },
      "3": {
        start: {
          line: 5,
          column: 24
        },
        end: {
          line: 5,
          column: 58
        }
      },
      "4": {
        start: {
          line: 6,
          column: 11
        },
        end: {
          line: 6,
          column: 23
        }
      },
      "5": {
        start: {
          line: 7,
          column: 24
        },
        end: {
          line: 25,
          column: 1
        }
      },
      "6": {
        start: {
          line: 8,
          column: 23
        },
        end: {
          line: 8,
          column: 64
        }
      },
      "7": {
        start: {
          line: 9,
          column: 24
        },
        end: {
          line: 9,
          column: 48
        }
      },
      "8": {
        start: {
          line: 10,
          column: 24
        },
        end: {
          line: 10,
          column: 54
        }
      },
      "9": {
        start: {
          line: 11,
          column: 21
        },
        end: {
          line: 14,
          column: 6
        }
      },
      "10": {
        start: {
          line: 15,
          column: 22
        },
        end: {
          line: 15,
          column: 67
        }
      },
      "11": {
        start: {
          line: 16,
          column: 17
        },
        end: {
          line: 16,
          column: 19
        }
      },
      "12": {
        start: {
          line: 17,
          column: 4
        },
        end: {
          line: 23,
          column: 5
        }
      },
      "13": {
        start: {
          line: 17,
          column: 17
        },
        end: {
          line: 17,
          column: 18
        }
      },
      "14": {
        start: {
          line: 18,
          column: 20
        },
        end: {
          line: 18,
          column: 32
        }
      },
      "15": {
        start: {
          line: 19,
          column: 8
        },
        end: {
          line: 22,
          column: 11
        }
      },
      "16": {
        start: {
          line: 24,
          column: 4
        },
        end: {
          line: 24,
          column: 18
        }
      },
      "17": {
        start: {
          line: 26,
          column: 0
        },
        end: {
          line: 26,
          column: 42
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 24
          },
          end: {
            line: 7,
            column: 25
          }
        },
        loc: {
          start: {
            line: 7,
            column: 44
          },
          end: {
            line: 25,
            column: 1
          }
        },
        line: 7
      }
    },
    branchMap: {},
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0
    },
    f: {
      "0": 0
    },
    b: {},
    inputSourceMap: {
      file: "C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\retrieval\\processing\\md.ts",
      mappings: ";;;AACA,iDAAsC;AACtC,2DAAwE;AACxE,wBAA6C;AAEtC,MAAM,eAAe,GAAG,KAAK,EAClC,QAAc,EACY,EAAE;IAC5B,MAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAA;IAC5D,MAAM,WAAW,GAAG,IAAI,WAAW,CAAC,OAAO,CAAC,CAAA;IAC5C,MAAM,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,CAAA;IAElD,MAAM,QAAQ,GAAG,8CAA8B,CAAC,YAAY,CAAC,UAAU,EAAE;QACvE,SAAS,EAAE,aAAU;QACrB,YAAY,EAAE,gBAAa;KAC5B,CAAC,CAAA;IAEF,MAAM,SAAS,GAAG,MAAM,QAAQ,CAAC,eAAe,CAAC,CAAC,WAAW,CAAC,CAAC,CAAA;IAE/D,IAAI,MAAM,GAAoB,EAAE,CAAA;IAEhC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QAC1C,MAAM,GAAG,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;QAExB,MAAM,CAAC,IAAI,CAAC;YACV,OAAO,EAAE,GAAG,CAAC,WAAW;YACxB,MAAM,EAAE,IAAA,sBAAM,EAAC,GAAG,CAAC,WAAW,CAAC,CAAC,MAAM;SACvC,CAAC,CAAA;IACJ,CAAC;IAED,OAAO,MAAM,CAAA;AACf,CAAC,CAAA;AA1BY,QAAA,eAAe,mBA0B3B",
      names: [],
      sources: ["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\retrieval\\processing\\md.ts"],
      sourcesContent: ["import { FileItemChunk } from \"@/types\"\r\nimport { encode } from \"gpt-tokenizer\"\r\nimport { RecursiveCharacterTextSplitter } from \"langchain/text_splitter\"\r\nimport { CHUNK_OVERLAP, CHUNK_SIZE } from \".\"\r\n\r\nexport const processMarkdown = async (\r\n  markdown: Blob\r\n): Promise<FileItemChunk[]> => {\r\n  const fileBuffer = Buffer.from(await markdown.arrayBuffer())\r\n  const textDecoder = new TextDecoder(\"utf-8\")\r\n  const textContent = textDecoder.decode(fileBuffer)\r\n\r\n  const splitter = RecursiveCharacterTextSplitter.fromLanguage(\"markdown\", {\r\n    chunkSize: CHUNK_SIZE,\r\n    chunkOverlap: CHUNK_OVERLAP\r\n  })\r\n\r\n  const splitDocs = await splitter.createDocuments([textContent])\r\n\r\n  let chunks: FileItemChunk[] = []\r\n\r\n  for (let i = 0; i < splitDocs.length; i++) {\r\n    const doc = splitDocs[i]\r\n\r\n    chunks.push({\r\n      content: doc.pageContent,\r\n      tokens: encode(doc.pageContent).length\r\n    })\r\n  }\r\n\r\n  return chunks\r\n}\r\n"],
      version: 3
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "1273665e7e42df594880c97cd5bed17eb9cb7379"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1tq9pndpei = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_1tq9pndpei();
cov_1tq9pndpei().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_1tq9pndpei().s[1]++;
exports.processMarkdown = void 0;
const gpt_tokenizer_1 =
/* istanbul ignore next */
(cov_1tq9pndpei().s[2]++, require("gpt-tokenizer"));
const text_splitter_1 =
/* istanbul ignore next */
(cov_1tq9pndpei().s[3]++, require("langchain/text_splitter"));
const _1 =
/* istanbul ignore next */
(cov_1tq9pndpei().s[4]++, require("."));
/* istanbul ignore next */
cov_1tq9pndpei().s[5]++;
const processMarkdown = async markdown => {
  /* istanbul ignore next */
  cov_1tq9pndpei().f[0]++;
  const fileBuffer =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[6]++, Buffer.from(await markdown.arrayBuffer()));
  const textDecoder =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[7]++, new TextDecoder("utf-8"));
  const textContent =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[8]++, textDecoder.decode(fileBuffer));
  const splitter =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[9]++, text_splitter_1.RecursiveCharacterTextSplitter.fromLanguage("markdown", {
    chunkSize: _1.CHUNK_SIZE,
    chunkOverlap: _1.CHUNK_OVERLAP
  }));
  const splitDocs =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[10]++, await splitter.createDocuments([textContent]));
  let chunks =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[11]++, []);
  /* istanbul ignore next */
  cov_1tq9pndpei().s[12]++;
  for (let i =
  /* istanbul ignore next */
  (cov_1tq9pndpei().s[13]++, 0); i < splitDocs.length; i++) {
    const doc =
    /* istanbul ignore next */
    (cov_1tq9pndpei().s[14]++, splitDocs[i]);
    /* istanbul ignore next */
    cov_1tq9pndpei().s[15]++;
    chunks.push({
      content: doc.pageContent,
      tokens: (0, gpt_tokenizer_1.encode)(doc.pageContent).length
    });
  }
  /* istanbul ignore next */
  cov_1tq9pndpei().s[16]++;
  return chunks;
};
/* istanbul ignore next */
cov_1tq9pndpei().s[17]++;
exports.processMarkdown = processMarkdown;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXRxOXBuZHBlaSIsImFjdHVhbENvdmVyYWdlIiwicyIsImdwdF90b2tlbml6ZXJfMSIsInJlcXVpcmUiLCJ0ZXh0X3NwbGl0dGVyXzEiLCJfMSIsInByb2Nlc3NNYXJrZG93biIsIm1hcmtkb3duIiwiZiIsImZpbGVCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiYXJyYXlCdWZmZXIiLCJ0ZXh0RGVjb2RlciIsIlRleHREZWNvZGVyIiwidGV4dENvbnRlbnQiLCJkZWNvZGUiLCJzcGxpdHRlciIsIlJlY3Vyc2l2ZUNoYXJhY3RlclRleHRTcGxpdHRlciIsImZyb21MYW5ndWFnZSIsImNodW5rU2l6ZSIsIkNIVU5LX1NJWkUiLCJjaHVua092ZXJsYXAiLCJDSFVOS19PVkVSTEFQIiwic3BsaXREb2NzIiwiY3JlYXRlRG9jdW1lbnRzIiwiY2h1bmtzIiwiaSIsImxlbmd0aCIsImRvYyIsInB1c2giLCJjb250ZW50IiwicGFnZUNvbnRlbnQiLCJ0b2tlbnMiLCJlbmNvZGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxwZWRyb1xcRG9jdW1lbnRzXFxHaXRIdWJcXEFzaXN0ZW50ZS1MZWdhbC1JbnRlbGlnZW50ZVxcbGliXFxyZXRyaWV2YWxcXHByb2Nlc3NpbmdcXG1kLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZpbGVJdGVtQ2h1bmsgfSBmcm9tIFwiQC90eXBlc1wiXHJcbmltcG9ydCB7IGVuY29kZSB9IGZyb20gXCJncHQtdG9rZW5pemVyXCJcclxuaW1wb3J0IHsgUmVjdXJzaXZlQ2hhcmFjdGVyVGV4dFNwbGl0dGVyIH0gZnJvbSBcImxhbmdjaGFpbi90ZXh0X3NwbGl0dGVyXCJcclxuaW1wb3J0IHsgQ0hVTktfT1ZFUkxBUCwgQ0hVTktfU0laRSB9IGZyb20gXCIuXCJcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9jZXNzTWFya2Rvd24gPSBhc3luYyAoXHJcbiAgbWFya2Rvd246IEJsb2JcclxuKTogUHJvbWlzZTxGaWxlSXRlbUNodW5rW10+ID0+IHtcclxuICBjb25zdCBmaWxlQnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgbWFya2Rvd24uYXJyYXlCdWZmZXIoKSlcclxuICBjb25zdCB0ZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcihcInV0Zi04XCIpXHJcbiAgY29uc3QgdGV4dENvbnRlbnQgPSB0ZXh0RGVjb2Rlci5kZWNvZGUoZmlsZUJ1ZmZlcilcclxuXHJcbiAgY29uc3Qgc3BsaXR0ZXIgPSBSZWN1cnNpdmVDaGFyYWN0ZXJUZXh0U3BsaXR0ZXIuZnJvbUxhbmd1YWdlKFwibWFya2Rvd25cIiwge1xyXG4gICAgY2h1bmtTaXplOiBDSFVOS19TSVpFLFxyXG4gICAgY2h1bmtPdmVybGFwOiBDSFVOS19PVkVSTEFQXHJcbiAgfSlcclxuXHJcbiAgY29uc3Qgc3BsaXREb2NzID0gYXdhaXQgc3BsaXR0ZXIuY3JlYXRlRG9jdW1lbnRzKFt0ZXh0Q29udGVudF0pXHJcblxyXG4gIGxldCBjaHVua3M6IEZpbGVJdGVtQ2h1bmtbXSA9IFtdXHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3BsaXREb2NzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBjb25zdCBkb2MgPSBzcGxpdERvY3NbaV1cclxuXHJcbiAgICBjaHVua3MucHVzaCh7XHJcbiAgICAgIGNvbnRlbnQ6IGRvYy5wYWdlQ29udGVudCxcclxuICAgICAgdG9rZW5zOiBlbmNvZGUoZG9jLnBhZ2VDb250ZW50KS5sZW5ndGhcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICByZXR1cm4gY2h1bmtzXHJcbn1cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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