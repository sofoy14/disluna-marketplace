{"file":"C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\__tests__\\lib\\parsers\\model-answer.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\__tests__\\lib\\parsers\\model-answer.test.ts"],"sourcesContent":["import { parseModelAnswer } from \"@/lib/parsers/model-answer\"\n\nconst sampleContent = `\nPlanteamiento del problema jurídico\n\nEl Ministerio Público consulta sobre la aplicación de la Ley 1437 de 2011.\n\n## Bibliografía\n- [Ley 1437 de 2011](https://www.suin.gov.co/lei-1437-2011)\n- Sentencia T-123 de 2018 — Corte Constitucional (https://www.corteconstitucional.gov.co/T-123-18)\n`\n\ndescribe(\"parseModelAnswer\", () => {\n  it(\"separates bibliography section and normalizes citations\", () => {\n    const result = parseModelAnswer(sampleContent)\n\n    expect(result.text).toContain(\"Planteamiento del problema jurídico\")\n    expect(result.text).not.toContain(\"Bibliografía\")\n    expect(result.citations).toBeDefined()\n    expect(result.citations?.length).toBe(2)\n    expect(result.citations?.[0].title).toBe(\"Ley 1437 de 2011\")\n    expect(result.citations?.[0].url).toBe(\"https://www.suin.gov.co/lei-1437-2011\")\n  })\n\n  it(\"detects inline bibliography sentences\", () => {\n    const content = `\nAnálisis preliminar\n\nFuentes consultadas: [Decreto 1082 de 2015](https://www.funcionpublica.gov.co/decreto-1082) ; Resolución 123 del 2020 https://www.minjusticia.gov.co/res-123-2020\n`\n    const result = parseModelAnswer(content)\n\n    expect(result.text).not.toContain(\"Fuentes consultadas\")\n    expect(result.citations?.length).toBe(2)\n    expect(result.citations?.[0].title).toContain(\"Decreto 1082 de 2015\")\n    expect(result.citations?.[1].url).toBe(\"https://www.minjusticia.gov.co/res-123-2020\")\n  })\n\n  it(\"uses backend bibliography when available\", () => {\n    const backendResult = parseModelAnswer(\"Respuesta sin sección visible\", {\n      citationsFromBackend: [\n        {\n          id: \"foo\",\n          title: \"Ley 80 de 1993\",\n          url: \"https://www.suin.gov.co/ley-80-1993\",\n          type: \"ley\",\n          description: \"Contratación estatal\"\n        }\n      ]\n    })\n\n    expect(backendResult.text).toBe(\"Respuesta sin sección visible\")\n    expect(backendResult.citations?.length).toBe(1)\n    expect(backendResult.citations?.[0].title).toBe(\"Ley 80 de 1993\")\n    expect(backendResult.citations?.[0].type).toBe(\"ley\")\n  })\n\n  it(\"returns clean text when no citations are present\", () => {\n    const content = \"Respuesta directa sin referencias externas.\"\n    const result = parseModelAnswer(content)\n\n    expect(result.text).toBe(content)\n    expect(result.citations).toBeUndefined()\n  })\n})\n\n"],"version":3}