{"version":3,"names":["cov_1mymjtsj5y","actualCoverage","s","gpt_tokenizer_1","require","json_1","text_splitter_1","_1","processJSON","json","f","loader","JSONLoader","docs","load","completeText","map","doc","pageContent","join","splitter","RecursiveCharacterTextSplitter","chunkSize","CHUNK_SIZE","chunkOverlap","CHUNK_OVERLAP","splitDocs","createDocuments","chunks","forEach","docTokens","encode","length","i","push","content","tokens","exports"],"sources":["C:\\Users\\pedro\\Documents\\GitHub\\Asistente-Legal-Inteligente\\lib\\retrieval\\processing\\json.ts"],"sourcesContent":["import { FileItemChunk } from \"@/types\"\r\nimport { encode } from \"gpt-tokenizer\"\r\nimport { JSONLoader } from \"langchain/document_loaders/fs/json\"\r\nimport { RecursiveCharacterTextSplitter } from \"langchain/text_splitter\"\r\nimport { CHUNK_OVERLAP, CHUNK_SIZE } from \".\"\r\n\r\nexport const processJSON = async (json: Blob): Promise<FileItemChunk[]> => {\r\n  const loader = new JSONLoader(json)\r\n  const docs = await loader.load()\r\n  let completeText = docs.map(doc => doc.pageContent).join(\" \")\r\n\r\n  const splitter = new RecursiveCharacterTextSplitter({\r\n    chunkSize: CHUNK_SIZE,\r\n    chunkOverlap: CHUNK_OVERLAP\r\n  })\r\n  const splitDocs = await splitter.createDocuments([completeText])\r\n\r\n  let chunks: FileItemChunk[] = []\r\n\r\n  splitDocs.forEach(doc => {\r\n    const docTokens = encode(doc.pageContent).length\r\n  })\r\n\r\n  for (let i = 0; i < splitDocs.length; i++) {\r\n    const doc = splitDocs[i]\r\n\r\n    chunks.push({\r\n      content: doc.pageContent,\r\n      tokens: encode(doc.pageContent).length\r\n    })\r\n  }\r\n\r\n  return chunks\r\n}\r\n"],"mappings":"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","ignoreList":[]}